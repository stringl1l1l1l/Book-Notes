# Rustç¨‹åºè®¾è®¡è¯­è¨€
## cargoåŸºç¡€
- **æ–°å»ºcargoé¡¹ç›®**
```
cargo new <project name>  
```
è¯¥å‘½ä»¤ç”Ÿæˆçš„é¡¹ç›®ç›®å½•ç»“æ„ï¼š  
src æºä»£ç ç›®å½•  
Cargo.toml è®°å½•é¡¹ç›®åŒ…ä¾èµ–  
.gitignore  

- **æ„å»ºcargoé¡¹ç›®**
```
cargo build             // debugæ¨¡å¼
cargo build âˆ’âˆ’release   // releaseæ¨¡å¼ï¼Œé€Ÿåº¦æ›´å¿«
```
è¯¥å‘½ä»¤é¢å¤–ç”Ÿæˆçš„æ–‡ä»¶å’Œç›®å½•ï¼š  
target  ç›®æ ‡æ–‡ä»¶ç›®å½•  
Cargo.lock è®°å½•ä¾èµ–åŒ…ç‰ˆæœ¬ï¼Œç¡®ä¿å¯é‡ç°æ„å»º  

- **æ„å»ºå¹¶è¿è¡Œcargoé¡¹ç›®**
```
cargo run
```

- **æ£€æŸ¥cargoé¡¹ç›®æ˜¯å¦æœ‰ç¼–è¯‘é”™è¯¯ï¼Œä¸ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶**
```
cargo check
```

## ruståŸºæœ¬è¯­æ³•  
> æ ‡æ³¨ğŸ§ä»£è¡¨ç›¸æ¯”äºC/C++ï¼Œrustçš„æ¯”è¾ƒæ˜æ˜¾çš„ä¸åŒä¹‹å¤„ã€‚  
>
> æ ‡æ³¨ğŸ¤”ä»£è¡¨æˆ‘è‡ªå·±æ¢ç´¢çš„ä¸€äº›å‘

### å˜é‡å’Œå¯å˜æ€§
#### å˜é‡
ğŸ§rustä¸­å˜é‡ä½¿ç”¨*let*å…³é”®å­—åˆ›å»ºï¼Œé»˜è®¤æ˜¯ä¸å¯å˜çš„ï¼ˆimmutableï¼‰ã€‚è‹¥å¸Œæœ›åˆ›å»ºå¯å˜å˜é‡ï¼Œéœ€æ·»åŠ *mut*å…³é”®å­—ã€‚
```rust
let mut x = 5;
println!("The value of x is: {x}");
x = 6;
println!("The value of x is: {x}");
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
The value of x is: 5
The value of x is: 6
```

#### å¸¸é‡
rustä¸­å¸¸é‡ä½¿ç”¨*const*å…³é”®å­—åˆ›å»ºï¼Œå¿…é¡»æ³¨æ˜å€¼çš„ç±»å‹ï¼Œå¿…é¡»èµ‹å€¼ï¼Œä¸€å®šæ˜¯ä¸å¯å˜çš„ï¼Œæ— æ³•æ·»åŠ *mut*å…³é”®å­—ã€‚  
```rust
const THREE_HOURS_IN_SECONDS: u32 = 60 * 60 * 3;
```
#### éšè— shadowingğŸ§
åœ¨rustä¸­ï¼Œé‡æ–°å¯¹åŒåå˜é‡è¿›è¡Œé‡å¤å£°æ˜ï¼Œæ–°å£°æ˜çš„å˜é‡ä¼šè¦†ç›–æ—§å˜é‡ï¼Œç§°ä¸ºéšè—ï¼ˆshadowingï¼‰ã€‚å¯ä»¥å¯¹åŒä¸€ä¸ªå˜é‡éšè—å¤šæ¬¡ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨ä¸åŒç±»å‹è¿›è¡Œéšè—ã€‚éœ€è¦æ³¨æ„éšè—æ˜¯æœ‰ä½œç”¨åŸŸçš„ã€‚    
```rust
fn main() {
    let x = 5;
    let x = x + 1;
    {
        let x = x * 2;
        println!("The value of x in the inner scope is: {x}");
    }
    println!("The value of x is: {x}");
}
________________________________________________________________________
The value of x in the inner scope is: 12
The value of x is: 6
```
éšè—å’Œmutçš„åŒºåˆ«ï¼š  
```rust
éšè—ï¼šå¯é€šè¿‡ç¼–è¯‘
let spaces = "   ";           // stringç±»å‹
let spaces = spaces.len();    // usizeç±»å‹

mutï¼šç¼–è¯‘é”™è¯¯
let mut spaces = "   ";
let spaces = spaces.len();
```

### æ•°æ®ç±»å‹  
rustçš„æ•°æ®ç±»å‹åˆ†ä¸ºä¸¤ç±»ï¼šæ ‡é‡ï¼ˆscalarï¼‰å’Œå¤åˆï¼ˆcompoundï¼‰ã€‚  
#### æ ‡é‡ç±»å‹  
å››ç§åŸºæœ¬æ ‡é‡ç±»å‹ï¼šæ•´å‹ã€æµ®ç‚¹å‹ã€å¸ƒå°”ç±»å‹å’Œå­—ç¬¦ç±»å‹ã€‚
- **æ•´å‹**  
i32æ˜¯æ•´å‹æ•°å­—é»˜è®¤ç±»å‹  
<table>
    <tr>
        <td>é•¿åº¦</td> <td>æœ‰ç¬¦å·</td> <td>æ— ç¬¦å·</td>
    </tr>
     <tr>
        <td>8-bit</td> <td>i8</td> <td>u8</td>
    </tr>
     <tr>
        <td>16-bit</td> <td>i16</td> <td>u16</td>
    </tr>
     <tr>
        <td>32-bit</td> <td>i32</td> <td>u32</td>
    </tr>
     <tr>
        <td>64-bit</td> <td>i64</td> <td>u64</td>
    </tr>
    <tr>
        <td>128-bit</td> <td>i128</td> <td>u128</td>
    </tr>
    <tr>
        <td>arch</td> <td>isize</td> <td>usize</td>
    </tr>
</table>  

<table>
<tr>
     <td>Decimal (åè¿›åˆ¶)</td>    <td>98_222</td>
</tr>
<tr>
 <td>Hex (åå…­è¿›åˆ¶)</td>    <td>0xff</td>
</tr>
<tr>
 <td>Octal (å…«è¿›åˆ¶)</td>	    <td>0o77</td>
</tr>
<tr>
 <td>Binary (äºŒè¿›åˆ¶)</td>    <td>0b1111_0000</td>
</tr>
<tr>
 <td>Byte (å•å­—èŠ‚å­—ç¬¦)(ä»…é™äºu8)</td>	 <td>b'A'</td>
</tr>
</table>
> æ•°å­—å­—é¢é‡å¯ä»¥æ·»åŠ ä¸‹åˆ’çº¿ï¼ˆ_ï¼‰åˆ†å‰²æ–¹ä¾¿é˜…è¯»ï¼Œå¦‚1000_0000ç­‰åŒäº10000000  

- **æµ®ç‚¹å‹**  
IEEE-754æ ‡å‡†ï¼Œf32å’Œf64ï¼Œé»˜è®¤ä¸ºf64ã€‚

- **å¸ƒå°”å‹**  
boolç±»å‹å¤§å°ä¸º1ä¸ªå­—èŠ‚ã€‚

- **å­—ç¬¦å‹**  
ğŸ§charç±»å‹å¤§å°ä¸º4ä¸ªå­—èŠ‚ï¼Œä»£è¡¨ä¸€ä¸ªUnicodeæ ‡é‡å€¼ã€‚
```rust
let c = 'z';
let z: char = 'â„¤'; // with explicit type annotation
let heart_eyed_cat = 'ğŸ˜»';
```
#### å¤åˆç±»å‹  
å¤åˆç±»å‹å¯ä»¥å°†å¤šä¸ªå€¼ç»„åˆæˆä¸€ä¸ªç±»å‹ã€‚rustæœ‰ä¸¤ä¸ªåŸç”Ÿçš„å¤åˆç±»å‹ï¼šå…ƒç»„ï¼ˆtupleï¼‰å’Œæ•°ç»„ï¼ˆarrayï¼‰ã€‚

- **å…ƒç»„ç±»å‹**  
å…ƒç»„æ˜¯ä¸€ä¸ªå°†å¤šä¸ªå…¶ä»–ç±»å‹çš„å€¼ç»„åˆè¿›ä¸€ä¸ªå¤åˆç±»å‹çš„ä¸»è¦æ–¹å¼ã€‚å…ƒç»„é•¿åº¦å›ºå®šï¼Œä¸€æ—¦å£°æ˜ï¼Œå…¶é•¿åº¦ä¸ä¼šå¢å¤§æˆ–ç¼©å°ã€‚
```rust
let tup: (i32, f64, u8) = (500, 6.4, 1);
```
ä¸ºäº†ä»å…ƒç»„ä¸­è·å–å•ä¸ªå€¼ï¼Œå¯ä»¥ä½¿ç”¨æ¨¡å¼åŒ¹é…ï¼ˆpattern matchingï¼‰æ¥è§£æ„ï¼ˆdestructureï¼‰å…ƒç»„å€¼ï¼š
```rust
let tup = (500, 6.4, 1);
let (x, y, z) = tup;
```
æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ç‚¹å·ï¼ˆ.ï¼‰åè·Ÿå€¼çš„ç´¢å¼•æ¥ç›´æ¥è®¿é—®å®ƒä»¬ã€‚ä¾‹å¦‚ï¼š
```rust
let x: (i32, f64, u8) = (500, 6.4, 1);
let five_hundred = x.0;
let six_point_four = x.1;
let one = x.2;
```
ğŸ§ä¸å¸¦ä»»ä½•å€¼çš„å…ƒç»„æœ‰ä¸ªç‰¹æ®Šçš„åç§°ï¼Œå«åš**å•å…ƒï¼ˆunitï¼‰å…ƒç»„**ã€‚è¿™ç§å€¼ä»¥åŠå¯¹åº”çš„ç±»å‹éƒ½å†™ä½œ `()`ï¼Œè¡¨ç¤ºç©ºå€¼æˆ–ç©ºçš„è¿”å›ç±»å‹ã€‚**å¦‚æœè¡¨è¾¾å¼ä¸è¿”å›ä»»ä½•å…¶ä»–å€¼ï¼Œåˆ™ä¼šéšå¼è¿”å›å•å…ƒå€¼**ã€‚

- **æ•°ç»„ç±»å‹**  
ä¸å…ƒç»„ä¸åŒï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ çš„ç±»å‹å¿…é¡»ç›¸åŒã€‚Rustä¸­çš„æ•°ç»„é•¿åº¦æ˜¯å›ºå®šçš„ã€‚
```rust
let a = [1, 2, 3, 4, 5];
```
å¯ä»¥åƒè¿™æ ·ç¼–å†™æ•°ç»„çš„ç±»å‹ï¼šåœ¨æ–¹æ‹¬å·ä¸­åŒ…å«æ¯ä¸ªå…ƒç´ çš„ç±»å‹ï¼Œåè·Ÿåˆ†å·ï¼Œå†åè·Ÿæ•°ç»„å…ƒç´ çš„æ•°é‡ï¼š
```rust
let a: [i32; 5] = [1, 2, 3, 4, 5];
```
å¯ä»¥é€šè¿‡åœ¨æ–¹æ‹¬å·ä¸­æŒ‡å®šåˆå§‹å€¼åŠ åˆ†å·å†åŠ å…ƒç´ ä¸ªæ•°çš„æ–¹å¼æ¥åˆ›å»ºä¸€ä¸ªæ¯ä¸ªå…ƒç´ éƒ½ä¸ºç›¸åŒå€¼çš„æ•°ç»„ï¼š
```rust
let a = [3; 5]; // [3, 3, 3, 3, 3]
```
è®¿é—®æ•°ç»„å…ƒç´ ï¼š
```rust
let a = [1, 2, 3, 4, 5];

let first = a[0];
let second = a[1];
```
ğŸ§åœ¨æ•°ç»„ä¸­è¶Šç•Œè®¿é—®å…ƒç´ ï¼Œä¼šå¯¼è‡´ä¸€ä¸ªè¿è¡Œæ—¶é”™è¯¯ï¼Œç¨‹åºç«‹å³åœ¨é”™è¯¯å¤„é€€å‡ºã€‚åœ¨Rustä¸­ï¼Œè¿™ç§æƒ…å†µç§°ä¸º*panic*ï¼ŒæŒ‡ç¨‹åºå› ä¸ºé”™è¯¯è€Œé€€å‡ºçš„æƒ…å†µã€‚  
### å‡½æ•°

åœ¨ Rust ä¸­é€šè¿‡è¾“å…¥ `fn` åé¢è·Ÿç€å‡½æ•°åå’Œä¸€å¯¹åœ†æ‹¬å·æ¥å®šä¹‰å‡½æ•°ã€‚  
Rust ä¸å…³å¿ƒå‡½æ•°å®šä¹‰æ‰€åœ¨çš„ä½ç½®ï¼Œåªè¦å‡½æ•°è¢«è°ƒç”¨æ—¶å‡ºç°åœ¨è°ƒç”¨ä¹‹å¤„å¯è§çš„ä½œç”¨åŸŸå†…å°±è¡Œã€‚  

#### å‚æ•°  
ğŸ§åœ¨å‡½æ•°ç­¾åä¸­ï¼Œ**å¿…é¡»** å£°æ˜æ¯ä¸ªå‚æ•°çš„ç±»å‹ã€‚è¿™æ˜¯ Rust è®¾è®¡ä¸­ä¸€ä¸ªç»è¿‡æ…é‡è€ƒè™‘çš„å†³å®šï¼šè¦æ±‚åœ¨å‡½æ•°å®šä¹‰ä¸­æä¾›ç±»å‹æ³¨è§£ã€‚  

```rust
fn main() {
    print_labeled_measurement(5, 'h');
}

fn print_labeled_measurement(value: i32, unit_label: char) {
    println!("The measurement is: {value}{unit_label}");
}
```

#### è¯­å¥å’Œè¡¨è¾¾å¼
ğŸ§Rust æ˜¯ä¸€é—¨åŸºäºè¡¨è¾¾å¼ï¼ˆexpression-basedï¼‰çš„è¯­è¨€ï¼Œè¿™æ˜¯ä¸€ä¸ªéœ€è¦ç†è§£çš„ä¸åŒäºå…¶ä»–è¯­è¨€çš„é‡è¦åŒºåˆ«ã€‚   
**è¯­å¥**ï¼ˆ*Statements*ï¼‰æ˜¯æ‰§è¡Œä¸€äº›æ“ä½œä½†ä¸è¿”å›å€¼çš„æŒ‡ä»¤ã€‚ **è¡¨è¾¾å¼**ï¼ˆ*Expressions*ï¼‰è®¡ç®—å¹¶äº§ç”Ÿä¸€ä¸ªå€¼ã€‚  

```rust
fn main() {
    let x = (let y = 6);
}
_________________________________
compile error!
```

ğŸ§`let y = 6` è¯­å¥å¹¶ä¸è¿”å›å€¼ï¼Œæ‰€ä»¥æ²¡æœ‰å¯ä»¥ç»‘å®šåˆ° `x` ä¸Šçš„å€¼ã€‚è¿™ä¸å…¶ä»–è¯­è¨€ä¸åŒï¼Œä¾‹å¦‚ C å’Œ Rubyï¼Œå®ƒä»¬çš„èµ‹å€¼è¯­å¥ä¼šè¿”å›æ‰€èµ‹çš„å€¼ã€‚åœ¨è¿™äº›è¯­è¨€ä¸­ï¼Œå¯ä»¥è¿™ä¹ˆå†™ `x = y = 6`ï¼Œè¿™æ · `x` å’Œ `y` çš„å€¼éƒ½æ˜¯ `6`ï¼›Rust ä¸­ä¸èƒ½è¿™æ ·å†™ã€‚  
```rust
fn main() {
    let y = {
        let x = 3;
        x + 1
    };

    println!("The value of y is: {y}");
}
```

>ğŸ§æ³¨æ„ `x+1` è¿™ä¸€è¡Œåœ¨ç»“å°¾æ²¡æœ‰åˆ†å·ï¼Œä¸è§è¿‡çš„å¤§éƒ¨åˆ†ä»£ç è¡Œä¸åŒã€‚**è¡¨è¾¾å¼çš„ç»“å°¾æ²¡æœ‰åˆ†å·ã€‚å¦‚æœåœ¨è¡¨è¾¾å¼çš„ç»“å°¾åŠ ä¸Šåˆ†å·ï¼Œå®ƒå°±å˜æˆäº†è¯­å¥ï¼Œè€Œè¯­å¥ä¸ä¼šè¿”å›å€¼ã€‚**

#### å…·æœ‰è¿”å›å€¼çš„å‡½æ•°  
  æˆ‘ä»¬å¹¶ä¸å¯¹å‡½æ•°è¿”å›å€¼å‘½åï¼Œä½†è¦åœ¨ç®­å¤´ï¼ˆ`->`ï¼‰åå£°æ˜å®ƒçš„ç±»å‹ã€‚åœ¨ Rust ä¸­ï¼Œå‡½æ•°çš„è¿”å›å€¼ç­‰åŒäºå‡½æ•°ä½“æœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ã€‚ä½¿ç”¨ `return` å…³é”®å­—å’ŒæŒ‡å®šå€¼ï¼Œå¯ä»å‡½æ•°ä¸­æå‰è¿”å›ï¼›ä½†å¤§éƒ¨åˆ†å‡½æ•°éšå¼çš„è¿”å›æœ€åçš„è¡¨è¾¾å¼ã€‚  

  ```rust
  fn main() {
      let x = plus_one(5);
      println!("The value of x is: {x}");
  }
  
  fn plus_one(x: i32) -> i32 {
      x + 1
  }
  ```

### æ§åˆ¶æµ

#### ifè¡¨è¾¾å¼

ğŸ§`if`åçš„æ¡ä»¶ **å¿…é¡»** æ˜¯ `bool` å€¼ã€‚å¦‚æœæ¡ä»¶ä¸æ˜¯ `bool` å€¼ï¼Œæˆ‘ä»¬å°†å¾—åˆ°ä¸€ä¸ªé”™è¯¯ã€‚

- **åœ¨letè¯­å¥ä¸­ä½¿ç”¨if**  
  å› ä¸º `if` æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ `let` è¯­å¥çš„å³ä¾§ä½¿ç”¨å®ƒã€‚

  ```rust
  fn main() {
      let condition = true;
      let number = if condition { 5 } else { 6 };
  
      println!("The value of number is: {number}");
  }
  ```
  è®°ä½ï¼Œä»£ç å—çš„å€¼æ˜¯å…¶æœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼Œè€Œæ•°å­—æœ¬èº«å°±æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ•´ä¸ª `if` è¡¨è¾¾å¼çš„å€¼å–å†³äºå“ªä¸ªä»£ç å—è¢«æ‰§è¡Œã€‚**è¿™æ„å‘³ç€ `if` çš„æ¯ä¸ªåˆ†æ”¯çš„å¯èƒ½çš„è¿”å›å€¼éƒ½å¿…é¡»æ˜¯ç›¸åŒç±»å‹ã€‚**å¦‚æœå®ƒä»¬çš„ç±»å‹ä¸åŒ¹é…ï¼Œå¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œåˆ™ä¼šå‡ºç°ä¸€ä¸ªé”™è¯¯ï¼š  

    ```rust
    fn main() {
        let condition = true;
    
        let number = if condition { 5 } else { "six" };
    
        println!("The value of number is: {number}");
    }
    ```

#### å¾ªç¯  

- **loopå¾ªç¯ï¼ˆæ— é™å¾ªç¯ï¼‰**  

  ```rust
  fn main() {
      loop {
          println!("again!");
      }
  }
  ```
  å¦‚æœå°†è¿”å›å€¼åŠ å…¥ä½ ç”¨æ¥åœæ­¢å¾ªç¯çš„ `break` è¡¨è¾¾å¼ï¼Œå®ƒä¼šè¢«åœæ­¢çš„å¾ªç¯è¿”å›ï¼š

  ```rust
  fn main() {
      let mut counter = 0;
  
      let result = loop {
          counter += 1;
  
          if counter == 10 {
              break counter * 2;
          }
      };
  
      println!("The result is {result}");
  }
  ___________________________________________
  The result is 20
  ```

- **ğŸ§å¾ªç¯æ ‡ç­¾**  
  å¦‚æœå­˜åœ¨åµŒå¥—å¾ªç¯ï¼Œ`break` å’Œ `continue` åº”ç”¨äºæ­¤æ—¶æœ€å†…å±‚çš„å¾ªç¯ã€‚ä½ å¯ä»¥é€‰æ‹©åœ¨ä¸€ä¸ªå¾ªç¯ä¸ŠæŒ‡å®šä¸€ä¸ª **å¾ªç¯æ ‡ç­¾**ï¼ˆ*loop label*ï¼‰ï¼Œç„¶åå°†æ ‡ç­¾ä¸ `break` æˆ– `continue` ä¸€èµ·ä½¿ç”¨ï¼Œä½¿è¿™äº›å…³é”®å­—åº”ç”¨äºå·²æ ‡è®°çš„å¾ªç¯è€Œä¸æ˜¯æœ€å†…å±‚çš„å¾ªç¯ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªåµŒå¥—å¾ªç¯çš„ç¤ºä¾‹ï¼š

  ```rust
  fn main() {
      let mut count = 0;
      'counting_up: loop {
          println!("count = {count}");
          let mut remaining = 10;
  
          loop {
              println!("remaining = {remaining}");
              if remaining == 9 {
                  break;
              }
              if count == 2 {
                  break 'counting_up;
              }
              remaining -= 1;
          }
  
          count += 1;
      }
      println!("End count = {count}");
  }
  ____________________________________________________________
  count = 0
  remaining = 10
  remaining = 9
  count = 1
  remaining = 10
  remaining = 9
  count = 2
  remaining = 10
  End count = 2
  ```
  
- **whileå¾ªç¯**  

  ```rust
  fn main() {
      let mut number = 3;
  
      while number != 0 {
          println!("{number}!");
  
          number -= 1;
      }
  
      println!("LIFTOFF!!!");
  }
  __________________________________
  3!
  2!
  1!
  LIFTOFF!!!
  ```
- **forå¾ªç¯**  

  ```rust
  fn main() {
      let a = [10, 20, 30, 40, 50];
  
      for element in a {
          println!("the value is: {element}");
      }
  }
  __________________________________________________
  the value is: 10
  the value is: 20
  the value is: 30
  the value is: 40
  the value is: 50
  ```
  é€šè¿‡ä½¿ç”¨ rangeï¼Œå®ƒæ˜¯æ ‡å‡†åº“æä¾›çš„ç±»å‹ï¼Œç”¨æ¥ç”Ÿæˆä»ä¸€ä¸ªæ•°å­—å¼€å§‹åˆ°å¦ä¸€ä¸ªæ•°å­—ä¹‹å‰ç»“æŸçš„æ‰€æœ‰æ•°å­—çš„åºåˆ—ï¼Œå¹¶ä½¿ç”¨`rev`åè½¬ rangeï¼š
  ```rust
  fn main() {
      for number in (1..4).rev() {
          println!("{number}!");
      }
      println!("LIFTOFF!!!");
  }
  _______________________________
  3!
  2!
  1!
  LIFTOFF!!!
  ```
  
- ***Rangeç±»å‹***

1. **Rangeï¼ˆ..ï¼‰å·¦é—­å³å¼€**

   ```rust
   fn main() {
       for i in 1..5 {
           println!("{}", i); // è¾“å‡º1, 2, 3, 4
       }
   }
   ```

2. **RangeInclusiveï¼ˆ..=ï¼‰å·¦é—­å³é—­**

   ```rust
   fn main() {
       for i in 1..=5 {
           println!("{}", i); // è¾“å‡º1, 2, 3, 4, 5
       }
   }
   ```

3. **RangeToï¼ˆ..endï¼‰0åˆ°æŸä¸ªç»“æŸå€¼ï¼ˆä¸åŒ…æ‹¬ï¼‰**

   ```rust
   fn main() {
       for i in ..5 {
           println!("{}", i); // è¾“å‡º0, 1, 2, 3, 4
       }
   }
   ```

4. **RangeToInclusiveï¼ˆ..=endï¼‰ï¼‰0åˆ°æŸä¸ªç»“æŸå€¼ï¼ˆåŒ…æ‹¬ï¼‰**

   ```rust
   fn main() {
       for i in ..=5 {
           println!("{}", i); // è¾“å‡º0, 1, 2, 3, 4, 5
       }
   }
   ```
### æ‰€æœ‰æƒğŸ§

æ‰€æœ‰æƒï¼ˆ*ownership*ï¼‰æ˜¯ Rust æœ€ä¸ºä¸ä¼—ä¸åŒçš„ç‰¹æ€§ï¼Œå¯¹è¯­è¨€çš„å…¶ä»–éƒ¨åˆ†æœ‰ç€æ·±åˆ»å«ä¹‰ã€‚å®ƒè®© Rust æ— éœ€åƒåœ¾å›æ”¶å³å¯ä¿éšœå†…å­˜å®‰å…¨ï¼Œå› æ­¤ç†è§£ Rust ä¸­æ‰€æœ‰æƒå¦‚ä½•å·¥ä½œæ˜¯ååˆ†é‡è¦çš„ã€‚  
è·Ÿè¸ªå“ªéƒ¨åˆ†ä»£ç æ­£åœ¨ä½¿ç”¨å †ä¸Šçš„å“ªäº›æ•°æ®ï¼Œæœ€å¤§é™åº¦çš„å‡å°‘å †ä¸Šçš„é‡å¤æ•°æ®çš„æ•°é‡ï¼Œä»¥åŠæ¸…ç†å †ä¸Šä¸å†ä½¿ç”¨çš„æ•°æ®ç¡®ä¿ä¸ä¼šè€—å°½ç©ºé—´ï¼Œè¿™äº›é—®é¢˜æ­£æ˜¯æ‰€æœ‰æƒç³»ç»Ÿè¦å¤„ç†çš„ã€‚ä¸€æ—¦ç†è§£äº†æ‰€æœ‰æƒï¼Œä½ å°±ä¸éœ€è¦ç»å¸¸è€ƒè™‘æ ˆå’Œå †äº†ï¼Œä¸è¿‡æ˜ç™½äº†**æ‰€æœ‰æƒçš„ä¸»è¦ç›®çš„å°±æ˜¯ä¸ºäº†ç®¡ç†å †æ•°æ®**ï¼Œèƒ½å¤Ÿå¸®åŠ©è§£é‡Šä¸ºä»€ä¹ˆæ‰€æœ‰æƒè¦ä»¥è¿™ç§æ–¹å¼å·¥ä½œã€‚

#### æ‰€æœ‰æƒè§„åˆ™

1. Rust ä¸­çš„æ¯ä¸€ä¸ªå€¼éƒ½æœ‰ä¸€ä¸ª **æ‰€æœ‰è€…**ï¼ˆ*owner*ï¼‰ã€‚
2. å€¼åœ¨ä»»ä¸€æ—¶åˆ»æœ‰ä¸”åªæœ‰ä¸€ä¸ªæ‰€æœ‰è€…ã€‚
3. å½“æ‰€æœ‰è€…ï¼ˆå˜é‡ï¼‰ç¦»å¼€ä½œç”¨åŸŸï¼Œè¿™ä¸ªå€¼å°†è¢«ä¸¢å¼ƒã€‚

#### å†…å­˜ä¸åˆ†é…

å†…å­˜åœ¨æ‹¥æœ‰å®ƒçš„å˜é‡ç¦»å¼€ä½œç”¨åŸŸåå°±è¢«è‡ªåŠ¨é‡Šæ”¾ï¼š

```rust
fn main() {
    {
        let s = String::from("hello"); // ä»æ­¤å¤„èµ·ï¼Œs æ˜¯æœ‰æ•ˆçš„
        // ä½¿ç”¨ s
    }                                  // æ­¤ä½œç”¨åŸŸå·²ç»“æŸï¼Œ
                                       // s ä¸å†æœ‰æ•ˆ
}
```

å½“ `s` ç¦»å¼€ä½œç”¨åŸŸçš„æ—¶å€™ã€‚å½“å˜é‡ç¦»å¼€ä½œç”¨åŸŸï¼ŒRust ä¸ºæˆ‘ä»¬è°ƒç”¨ä¸€ä¸ªç‰¹æ®Šçš„å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°å«åš [`drop`](https://doc.rust-lang.org/std/ops/trait.Drop.html#tymethod.drop)ï¼Œåœ¨è¿™é‡Œ `String` çš„ä½œè€…å¯ä»¥æ”¾ç½®é‡Šæ”¾å†…å­˜çš„ä»£ç ã€‚Rust åœ¨ç»“å°¾çš„ `}` å¤„è‡ªåŠ¨è°ƒç”¨ `drop`ã€‚

è¿™ä¸ªæ¨¡å¼å¯¹ç¼–å†™ Rust ä»£ç çš„æ–¹å¼æœ‰ç€æ·±è¿œçš„å½±å“ã€‚ç°åœ¨å®ƒçœ‹èµ·æ¥å¾ˆç®€å•ï¼Œä¸è¿‡åœ¨æ›´å¤æ‚çš„åœºæ™¯ä¸‹ä»£ç çš„è¡Œä¸ºå¯èƒ½æ˜¯ä¸å¯é¢„æµ‹çš„ï¼Œæ¯”å¦‚å½“æœ‰å¤šä¸ªå˜é‡ä½¿ç”¨åœ¨å †ä¸Šåˆ†é…çš„å†…å­˜æ—¶ã€‚ç°åœ¨è®©æˆ‘ä»¬æ¢ç´¢ä¸€äº›è¿™æ ·çš„åœºæ™¯ã€‚
- **å˜é‡ä¸æ•°æ®äº¤äº’çš„æ–¹å¼ï¼ˆä¸€ï¼‰ï¼šç§»åŠ¨**    
  
  ```rust
  fn main() {
      let s1 = String::from("hello");
      let s2 = s1;
  
      println!("{}, world!", s1);
  
  }
  _______________________________________
  compile error !
  ```
  <img src=".\images\Rust_4-1.png" alt="s1å’Œs2çš„å†…å­˜åˆ†å¸ƒ" style="zoom: 67%;" />
  `s1` `s2`æŒ‡å‘åŒä¸€å—å †å†…å­˜ï¼Œå½“å®ƒä»¬ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œå®ƒä»¬éƒ½ä¼šå°è¯•é‡Šæ”¾ç›¸åŒçš„å†…å­˜ã€‚è¿™æ˜¯ä¸€ä¸ªå«åš**äºŒæ¬¡é‡Šæ”¾ï¼ˆdouble free)**çš„é”™è¯¯ã€‚ä¸¤æ¬¡é‡Šæ”¾ç›¸åŒå†…å­˜ä¼šå¯¼è‡´å†…å­˜æ±¡æŸ“ï¼Œå®ƒå¯èƒ½ä¼šå¯¼è‡´æ½œåœ¨çš„å®‰å…¨æ¼æ´ã€‚
  ä¸ºäº†ç¡®ä¿å†…å­˜å®‰å…¨ï¼Œåœ¨ `let s2 = s1;` ä¹‹åï¼ŒRust è®¤ä¸º `s1` ä¸å†æœ‰æ•ˆï¼Œå› æ­¤ Rust ä¸éœ€è¦åœ¨ `s1` ç¦»å¼€ä½œç”¨åŸŸåæ¸…ç†ä»»ä½•ä¸œè¥¿ã€‚è¿™æ ·å°±è§£å†³äº†æˆ‘ä»¬çš„é—®é¢˜ï¼å› ä¸ºåªæœ‰ `s2` æ˜¯æœ‰æ•ˆçš„ï¼Œå½“å…¶ç¦»å¼€ä½œç”¨åŸŸï¼Œå®ƒå°±é‡Šæ”¾è‡ªå·±çš„å†…å­˜ã€‚

  å¦å¤–ï¼Œè¿™é‡Œè¿˜éšå«äº†ä¸€ä¸ªè®¾è®¡é€‰æ‹©ï¼š**Rust æ°¸è¿œä¹Ÿä¸ä¼šè‡ªåŠ¨åˆ›å»ºæ•°æ®çš„ â€œæ·±æ‹·è´â€**ã€‚å› æ­¤ï¼Œä»»ä½• **è‡ªåŠ¨** çš„å¤åˆ¶å¯ä»¥è¢«è®¤ä¸ºå¯¹è¿è¡Œæ—¶æ€§èƒ½å½±å“è¾ƒå°ã€‚
  
- **å˜é‡ä¸æ•°æ®äº¤äº’çš„æ–¹å¼ï¼ˆäºŒï¼‰ï¼šå…‹éš†**  

  ```rust
  fn main() {
      let s1 = String::from("hello");
      let s2 = s1.clone();
  
      println!("s1 = {}, s2 = {}", s1, s2);
  }
  ```

  è¿™æ®µä»£ç èƒ½æ­£å¸¸è¿è¡Œï¼Œè¿™é‡Œå †ä¸Šçš„æ•°æ®ç¡®å®è¢«å¤åˆ¶äº†ã€‚å½“å‡ºç° `clone` è°ƒç”¨æ—¶ï¼Œä¼šè¿›è¡Œæ·±æ‹·è´ã€‚

- **åªåœ¨æ ˆä¸Šçš„æ‹·è´**  

  ```rust
  fn main() {
      let x = 5;
      let y = x;
  
      println!("x = {}, y = {}", x, y);
  }
  ```

  è¿™æ®µä»£ç ä¼¼ä¹ä¸æˆ‘ä»¬åˆšåˆšå­¦åˆ°çš„å†…å®¹ç›¸çŸ›ç›¾ï¼šæ²¡æœ‰è°ƒç”¨ `clone`ï¼Œä¸è¿‡ `x` ä¾ç„¶æœ‰æ•ˆä¸”æ²¡æœ‰è¢«ç§»åŠ¨åˆ° `y` ä¸­ã€‚

  åŸå› æ˜¯åƒæ•´å‹è¿™æ ·çš„åœ¨ç¼–è¯‘æ—¶å·²çŸ¥å¤§å°çš„ç±»å‹è¢«æ•´ä¸ªå­˜å‚¨åœ¨æ ˆä¸Šï¼Œè¿™é‡Œæ²¡æœ‰æ·±æµ…æ‹·è´çš„åŒºåˆ«ï¼Œæ‰€ä»¥è¿™é‡Œè°ƒç”¨ `clone` å¹¶ä¸ä¼šä¸é€šå¸¸çš„æµ…æ‹·è´æœ‰ä»€ä¹ˆä¸åŒã€‚

  ç¬¦åˆè¯¥ç‰¹å¾çš„æ•°æ®ç±»å‹æœ‰ï¼š

  - æ‰€æœ‰æ•´æ•°ç±»å‹ï¼Œæ¯”å¦‚ `u32`ã€‚
  - å¸ƒå°”ç±»å‹ï¼Œ`bool`ï¼Œå®ƒçš„å€¼æ˜¯ `true` å’Œ `false`ã€‚
  - æ‰€æœ‰æµ®ç‚¹æ•°ç±»å‹ï¼Œæ¯”å¦‚ `f64`ã€‚
  - å­—ç¬¦ç±»å‹ï¼Œ`char`ã€‚
  - å…ƒç»„ï¼Œå½“ä¸”ä»…å½“å…¶åŒ…å«çš„ç±»å‹ä¹Ÿéƒ½å®ç° `Copy` çš„æ—¶å€™ã€‚æ¯”å¦‚ï¼Œ`(i32, i32)` å®ç°äº† `Copy`ï¼Œä½† `(i32, String)` å°±æ²¡æœ‰ã€‚

#### éšå¼ç§»åŠ¨å‘ç”Ÿçš„æ—¶æœºğŸ¤”

- match æ¨¡å¼åŒ¹é…

  ```rust
  fn main() {
      let v: String = String::from("hello");
      let r = &v;
  
      match v {
          value => println!("{v}") // æ­¤å¤„vè¢«ç§»åŠ¨åˆ°valueï¼Œå› æ­¤æ— æ³•æ‰“å°v
      } // é‡Šæ”¾valueçš„å †ç©ºé—´
      println!("{v}") // æ­¤å¤„vå†…å­˜è¢«é‡Šæ”¾ï¼ŒåŒæ ·æ— æ³•æ‰“å°
  }
  ```

  ```rust
  fn main() {
      let v: String = String::from("hello");
      let r = &v;
  
      match r { // æ›¿æ¢ä¸ºå¼•ç”¨å³å¯æ­£å¸¸è¿è¡Œ
          value => println!("{v}") 
      } 
      println!("{v}") 
  }
  ```

  

#### æ‰€æœ‰æƒä¸å‡½æ•°

å°†å€¼ä¼ é€’ç»™å‡½æ•°ä¸ç»™å˜é‡èµ‹å€¼çš„åŸç†ç›¸ä¼¼ã€‚å‘å‡½æ•°ä¼ é€’å€¼å¯èƒ½ä¼šç§»åŠ¨æˆ–è€…å¤åˆ¶ï¼Œå°±åƒèµ‹å€¼è¯­å¥ä¸€æ ·ã€‚ä¸‹é¢çš„æ³¨é‡Šå±•ç¤ºå˜é‡ä½•æ—¶è¿›å…¥å’Œç¦»å¼€ä½œç”¨åŸŸï¼š

```rust
fn main() {
    let s = String::from("hello");  // s è¿›å…¥ä½œç”¨åŸŸ

    takes_ownership(s);             // s çš„å€¼ç§»åŠ¨åˆ°å‡½æ•°é‡Œ ...
                                    // ... æ‰€ä»¥åˆ°è¿™é‡Œä¸å†æœ‰æ•ˆ

    let x = 5;                      // x è¿›å…¥ä½œç”¨åŸŸ

    makes_copy(x);                  // x åº”è¯¥ç§»åŠ¨å‡½æ•°é‡Œï¼Œ
                                    // ä½† i32 æ˜¯ Copy çš„ï¼Œ
                                    // æ‰€ä»¥åœ¨åé¢å¯ç»§ç»­ä½¿ç”¨ x

} // è¿™é‡Œï¼Œx å…ˆç§»å‡ºäº†ä½œç”¨åŸŸï¼Œç„¶åæ˜¯ sã€‚ä½†å› ä¸º s çš„å€¼å·²è¢«ç§»èµ°ï¼Œ
  // æ²¡æœ‰ç‰¹æ®Šä¹‹å¤„

fn takes_ownership(some_string: String) { // some_string è¿›å…¥ä½œç”¨åŸŸ
    println!("{}", some_string);
} // è¿™é‡Œï¼Œsome_string ç§»å‡ºä½œç”¨åŸŸå¹¶è°ƒç”¨ `drop` æ–¹æ³•ã€‚
  // å ç”¨çš„å†…å­˜è¢«é‡Šæ”¾

fn makes_copy(some_integer: i32) { // some_integer è¿›å…¥ä½œç”¨åŸŸ
    println!("{}", some_integer);
} // è¿™é‡Œï¼Œsome_integer ç§»å‡ºä½œç”¨åŸŸã€‚æ²¡æœ‰ç‰¹æ®Šä¹‹å¤„
```

#### å¼•ç”¨å’Œå€Ÿç”¨

**å¼•ç”¨**ï¼ˆ*reference*ï¼‰åƒä¸€ä¸ªæŒ‡é’ˆï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªåœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥ç”±æ­¤è®¿é—®å‚¨å­˜äºè¯¥åœ°å€çš„å±äºå…¶ä»–å˜é‡çš„æ•°æ®ã€‚ ä¸æŒ‡é’ˆä¸åŒï¼Œå¼•ç”¨ç¡®ä¿æŒ‡å‘æŸä¸ªç‰¹å®šç±»å‹çš„æœ‰æ•ˆå€¼ã€‚**å¼•ç”¨å…è®¸ä½ ä½¿ç”¨å€¼ä½†ä¸è·å–å…¶æ‰€æœ‰æƒ**ã€‚

```rust
fn main() {
    let s1 = String::from("hello");

    let len = calculate_length(&s1);

    println!("The length of '{}' is {}.", s1, len);
}

fn calculate_length(s: &String) -> usize {
    s.len()
}
```

<img src=".\images\Rust_4-2.png" alt="å¼•ç”¨" style="zoom:67%;" />

åŒç†ï¼Œå‡½æ•°ç­¾åä½¿ç”¨ `&` æ¥è¡¨æ˜å‚æ•° `s`çš„ç±»å‹æ˜¯ä¸€ä¸ªå¼•ç”¨ã€‚è®©æˆ‘ä»¬å¢åŠ ä¸€äº›è§£é‡Šæ€§çš„æ³¨é‡Šï¼š

```rust
fn main() {
    let s1 = String::from("hello");

    let len = calculate_length(&s1);

    println!("The length of '{}' is {}.", s1, len);
}

fn calculate_length(s: &String) -> usize { // s æ˜¯ String çš„å¼•ç”¨
    s.len()
} // è¿™é‡Œï¼Œs ç¦»å¼€äº†ä½œç”¨åŸŸã€‚ä½†å› ä¸ºå®ƒå¹¶ä¸æ‹¥æœ‰å¼•ç”¨å€¼çš„æ‰€æœ‰æƒï¼Œ
  // æ‰€ä»¥ä»€ä¹ˆä¹Ÿä¸ä¼šå‘ç”Ÿ
```

æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå¼•ç”¨çš„è¡Œä¸ºç§°ä¸º **å€Ÿç”¨**ï¼ˆ*borrowing*ï¼‰ã€‚æ­£å¦‚ç°å®ç”Ÿæ´»ä¸­ï¼Œå¦‚æœä¸€ä¸ªäººæ‹¥æœ‰æŸæ ·ä¸œè¥¿ï¼Œä½ å¯ä»¥ä»ä»–é‚£é‡Œå€Ÿæ¥ã€‚å½“ä½ ä½¿ç”¨å®Œæ¯•ï¼Œå¿…é¡»è¿˜å›å»ã€‚æˆ‘ä»¬å¹¶ä¸æ‹¥æœ‰å®ƒï¼Œå› æ­¤æˆ‘ä»¬æ— æ³•ä¿®æ”¹å¼•ç”¨çš„å˜é‡ï¼š

```rust
fn main() {
    let s = String::from("hello");
    change(&s);
}

fn change(some_string: &String) {
    some_string.push_str(", world");
}
________________________________________
compile error !
```

#### å¯å˜å¼•ç”¨

æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå°è°ƒæ•´å°±èƒ½ä¿®å¤ç¤ºä¾‹ 4-6 ä»£ç ä¸­çš„é”™è¯¯ï¼Œå…è®¸æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸ªå€Ÿç”¨çš„å€¼ï¼Œè¿™å°±æ˜¯ **å¯å˜å¼•ç”¨**ï¼ˆ*mutable reference*ï¼‰ï¼š

```rust
fn main() {
    let mut s = String::from("hello");

    change(&mut s);
}

fn change(some_string: &mut String) {
    some_string.push_str(", world");
}
```

å¯å˜å¼•ç”¨æœ‰ä¸€ä¸ªå¾ˆå¤§çš„é™åˆ¶ï¼šå¦‚æœä½ æœ‰ä¸€ä¸ªå¯¹è¯¥å˜é‡çš„å¯å˜å¼•ç”¨ï¼Œä½ å°±ä¸èƒ½ä½¿ç”¨è¯¥å˜é‡çš„å¦ä¸€ä¸ªå¯å˜å¼•ç”¨ã€‚åŒæ—¶ä½¿ç”¨ä¸¤ä¸ª `s` çš„å¯å˜å¼•ç”¨çš„ä»£ç ä¼šå¤±è´¥ï¼š

```rust
fn main() {
    let mut s = String::from("hello");

    let r1 = &mut s;
    let r2 = &mut s;

    println!("{}, {}", r1, r2); // compile error !
    
    println!("{}", r1); // compile error !
    println!("{}", r2); // å¯ä»¥
}
```

è¿™ä¸€é™åˆ¶ä»¥ä¸€ç§éå¸¸å°å¿ƒè°¨æ…çš„æ–¹å¼å…è®¸å¯å˜æ€§ï¼Œé˜²æ­¢åŒä¸€æ—¶é—´å¯¹åŒä¸€æ•°æ®å­˜åœ¨å¤šä¸ªå¯å˜å¼•ç”¨ã€‚æ–° Rustacean ä»¬ç»å¸¸éš¾ä»¥é€‚åº”è¿™ä¸€ç‚¹ï¼Œå› ä¸ºå¤§éƒ¨åˆ†è¯­è¨€ä¸­å˜é‡ä»»ä½•æ—¶å€™éƒ½æ˜¯å¯å˜çš„ã€‚è¿™ä¸ªé™åˆ¶çš„å¥½å¤„æ˜¯ Rust å¯ä»¥åœ¨ç¼–è¯‘æ—¶å°±é¿å…æ•°æ®ç«äº‰ã€‚**æ•°æ®ç«äº‰**ï¼ˆ*data race*ï¼‰ç±»ä¼¼äºç«æ€æ¡ä»¶ï¼Œå®ƒå¯ç”±è¿™ä¸‰ä¸ªè¡Œä¸ºé€ æˆï¼š

- ä¸¤ä¸ªæˆ–æ›´å¤šæŒ‡é’ˆåŒæ—¶è®¿é—®åŒä¸€æ•°æ®ã€‚
- è‡³å°‘æœ‰ä¸€ä¸ªæŒ‡é’ˆè¢«ç”¨æ¥å†™å…¥æ•°æ®ã€‚
- æ²¡æœ‰åŒæ­¥æ•°æ®è®¿é—®çš„æœºåˆ¶ã€‚

æ•°æ®ç«äº‰ä¼šå¯¼è‡´æœªå®šä¹‰è¡Œä¸ºï¼Œéš¾ä»¥åœ¨è¿è¡Œæ—¶è¿½è¸ªï¼Œå¹¶ä¸”éš¾ä»¥è¯Šæ–­å’Œä¿®å¤ï¼›Rust é¿å…äº†è¿™ç§æƒ…å†µçš„å‘ç”Ÿï¼Œå› ä¸ºå®ƒç”šè‡³ä¸ä¼šç¼–è¯‘å­˜åœ¨æ•°æ®ç«äº‰çš„ä»£ç ï¼

ä¸€å¦‚æ—¢å¾€ï¼Œå¯ä»¥ä½¿ç”¨å¤§æ‹¬å·æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ä½œç”¨åŸŸï¼Œä»¥å…è®¸æ‹¥æœ‰å¤šä¸ªå¯å˜å¼•ç”¨ï¼Œåªæ˜¯ä¸èƒ½ **åŒæ—¶** æ‹¥æœ‰ï¼šï¼ˆå†™å†™å†²çªï¼‰

```rust
    let mut s = String::from("hello");

    {
        let r1 = &mut s;
    } // r1 åœ¨è¿™é‡Œç¦»å¼€äº†ä½œç”¨åŸŸï¼Œæ‰€ä»¥æˆ‘ä»¬å®Œå…¨å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„å¼•ç”¨

    let r2 = &mut s;
```

æˆ‘ä»¬ä¹Ÿä¸èƒ½åœ¨æ‹¥æœ‰ä¸å¯å˜å¼•ç”¨çš„åŒæ—¶æ‹¥æœ‰å¯å˜å¼•ç”¨ã€‚Rust åœ¨åŒæ—¶ä½¿ç”¨å¯å˜ä¸ä¸å¯å˜å¼•ç”¨æ—¶ä¹Ÿé‡‡ç”¨çš„ç±»ä¼¼çš„è§„åˆ™ã€‚è¿™äº›ä»£ç ä¼šå¯¼è‡´ä¸€ä¸ªé”™è¯¯ï¼šï¼ˆè¯»å†™å†²çªï¼‰

```rust
    let mut s = String::from("hello");

    let r1 = &s; // æ²¡é—®é¢˜
    let r2 = &s; // æ²¡é—®é¢˜
    let r3 = &mut s; // å¤§é—®é¢˜

    println!("{}, {}, and {}", r1, r2, r3);
____________________________________________________
compile error !
```

#### æ‚¬ç©ºå¼•ç”¨

åœ¨å…·æœ‰æŒ‡é’ˆçš„è¯­è¨€ä¸­ï¼Œå¾ˆå®¹æ˜“é€šè¿‡é‡Šæ”¾å†…å­˜æ—¶ä¿ç•™æŒ‡å‘å®ƒçš„æŒ‡é’ˆè€Œé”™è¯¯åœ°ç”Ÿæˆä¸€ä¸ª **æ‚¬å‚æŒ‡é’ˆ**ï¼ˆ*dangling pointer*ï¼‰ï¼Œæ‰€è°“æ‚¬å‚æŒ‡é’ˆæ˜¯å…¶æŒ‡å‘çš„å†…å­˜å¯èƒ½å·²ç»è¢«åˆ†é…ç»™å…¶å®ƒæŒæœ‰è€…ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œåœ¨ Rust ä¸­ç¼–è¯‘å™¨ç¡®ä¿å¼•ç”¨æ°¸è¿œä¹Ÿä¸ä¼šå˜æˆæ‚¬å‚çŠ¶æ€ï¼šå½“ä½ æ‹¥æœ‰ä¸€äº›æ•°æ®çš„å¼•ç”¨ï¼Œç¼–è¯‘å™¨ç¡®ä¿æ•°æ®ä¸ä¼šåœ¨å…¶å¼•ç”¨ä¹‹å‰ç¦»å¼€ä½œç”¨åŸŸã€‚

è®©æˆ‘ä»¬å°è¯•åˆ›å»ºä¸€ä¸ªæ‚¬å‚å¼•ç”¨ï¼ŒRust ä¼šé€šè¿‡ä¸€ä¸ªç¼–è¯‘æ—¶é”™è¯¯æ¥é¿å…ï¼š

æ–‡ä»¶åï¼šsrc/main.rs

```rust
fn main() {
    let reference_to_nothing = dangle();
}

fn dangle() -> &String { // dangle è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²çš„å¼•ç”¨

    let s = String::from("hello"); // s æ˜¯ä¸€ä¸ªæ–°å­—ç¬¦ä¸²

    &s // è¿”å›å­—ç¬¦ä¸² s çš„å¼•ç”¨
} // è¿™é‡Œ s ç¦»å¼€ä½œç”¨åŸŸå¹¶è¢«ä¸¢å¼ƒï¼Œå…¶å†…å­˜è¢«é‡Šæ”¾ï¼Œæˆä¸ºæ‚¬ç©ºå¼•ç”¨
________________________________________________________
compile error !
```

è¿™é‡Œçš„è§£å†³æ–¹æ³•æ˜¯ç›´æ¥è¿”å› `String`ï¼š

```rust
fn no_dangle() -> String {
    let s = String::from("hello");

    s
}
```

#### åˆ‡ç‰‡ SliceğŸ§

*slice* å…è®¸ä½ å¼•ç”¨é›†åˆä¸­ä¸€æ®µè¿ç»­çš„å…ƒç´ åºåˆ—ï¼Œè€Œä¸ç”¨å¼•ç”¨æ•´ä¸ªé›†åˆã€‚slice æ˜¯ä¸€ç±»å¼•ç”¨ï¼Œæ‰€ä»¥å®ƒæ²¡æœ‰æ‰€æœ‰æƒã€‚

ä¸€ä¸ªåˆ‡ç‰‡å¼•ç”¨å ç”¨äº†2ä¸ªå­—å¤§å°çš„å†…å­˜ç©ºé—´( ä»ç°åœ¨å¼€å§‹ï¼Œä¸ºäº†ç®€æ´æ€§è€ƒè™‘ï¼Œå¦‚æ— ç‰¹æ®ŠåŸå› ï¼Œ**æˆ‘ä»¬ç»Ÿä¸€ä½¿ç”¨åˆ‡ç‰‡æ¥ç‰¹æŒ‡åˆ‡ç‰‡å¼•ç”¨** )ã€‚ è¯¥åˆ‡ç‰‡çš„ç¬¬ä¸€ä¸ªå­—æ˜¯æŒ‡å‘æ•°æ®çš„æŒ‡é’ˆï¼Œç¬¬äºŒä¸ªå­—æ˜¯åˆ‡ç‰‡çš„é•¿åº¦ã€‚å­—çš„å¤§å°å–å†³äºå¤„ç†å™¨æ¶æ„ï¼Œä¾‹å¦‚åœ¨ `x86-64` ä¸Šï¼Œå­—çš„å¤§å°æ˜¯ 64 ä½ä¹Ÿå°±æ˜¯ 8 ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆä¸€ä¸ªåˆ‡ç‰‡å¼•ç”¨å°±æ˜¯ 16 ä¸ªå­—èŠ‚å¤§å°ã€‚

- **å­—ç¬¦ä¸²slice**   
  **å­—ç¬¦ä¸² slice**ï¼ˆ*string slice*ï¼‰æ˜¯ `String` ä¸­ä¸€éƒ¨åˆ†å€¼çš„å¼•ç”¨ï¼Œå®ƒçœ‹èµ·æ¥åƒè¿™æ ·ï¼š

  ```rust
      let s = String::from("hello world");
  
      let hello = &s[0..5];
      let world = &s[6..11];
  ```

  å¯¹äº Rust çš„ `..` range è¯­æ³•ï¼Œå¦‚æœæƒ³è¦ä»ç´¢å¼• 0 å¼€å§‹ï¼Œå¯ä»¥ä¸å†™ä¸¤ä¸ªç‚¹å·ä¹‹å‰çš„å€¼ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚ä¸‹ä¸¤ä¸ªè¯­å¥æ˜¯ç›¸åŒçš„ï¼š
  
  ```rust
  let s = String::from("hello");
  
  let slice = &s[0..2];
  let slice = &s[..2];
  ```
  
  ä¾æ­¤ç±»æ¨ï¼Œå¦‚æœ slice åŒ…å« `String` çš„æœ€åä¸€ä¸ªå­—èŠ‚ï¼Œä¹Ÿå¯ä»¥èˆå¼ƒå°¾éƒ¨çš„æ•°å­—ã€‚è¿™æ„å‘³ç€å¦‚ä¸‹ä¹Ÿæ˜¯ç›¸åŒçš„ï¼š
  
  ```rust
  let s = String::from("hello");
  
  let len = s.len();
  
  let slice = &s[3..len];
  let slice = &s[3..];
  ```
  
  ä¹Ÿå¯ä»¥åŒæ—¶èˆå¼ƒè¿™ä¸¤ä¸ªå€¼æ¥è·å–æ•´ä¸ªå­—ç¬¦ä¸²çš„ sliceã€‚æ‰€ä»¥å¦‚ä¸‹äº¦æ˜¯ç›¸åŒçš„ï¼š
  
  ```rust
  let s = String::from("hello");
  
  let len = s.len();
  
  let slice = &s[0..len];
  let slice = &s[..];
  ```
- ğŸ§**å­—ç¬¦ä¸²å­—é¢å€¼å°±æ˜¯ slice**
  
  ```rust
  let s = "Hello, world!";
  ```
  
  è¿™é‡Œ s çš„ç±»å‹æ˜¯ &strï¼šå®ƒæ˜¯ä¸€ä¸ªæŒ‡å‘äºŒè¿›åˆ¶ç¨‹åºç‰¹å®šä½ç½®çš„ sliceã€‚è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆå­—ç¬¦ä¸²å­—é¢å€¼æ˜¯ä¸å¯å˜çš„ï¼š&str æ˜¯ä¸€ä¸ªä¸å¯å˜å¼•ç”¨ã€‚

- **å…¶ä»–ç±»å‹çš„slice**

  å­—ç¬¦ä¸² sliceï¼Œæ­£å¦‚ä½ æƒ³è±¡çš„é‚£æ ·ï¼Œæ˜¯é’ˆå¯¹å­—ç¬¦ä¸²çš„ã€‚ä¸è¿‡ä¹Ÿæœ‰æ›´é€šç”¨çš„ slice ç±»å‹ã€‚è€ƒè™‘ä¸€ä¸‹è¿™ä¸ªæ•°ç»„ï¼š

  ```rust
  let a = [1, 2, 3, 4, 5];
  ```

  å°±è·Ÿæˆ‘ä»¬æƒ³è¦è·å–å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†é‚£æ ·ï¼Œæˆ‘ä»¬ä¹Ÿä¼šæƒ³è¦å¼•ç”¨æ•°ç»„çš„ä¸€éƒ¨åˆ†ã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼š

  ```rust
  let a = [1, 2, 3, 4, 5];
  
  let slice = &a[1..3];
  
  assert_eq!(slice, &[2, 3]);
  ```

  è¿™ä¸ª slice çš„ç±»å‹æ˜¯ `&[i32]`ã€‚å®ƒè·Ÿå­—ç¬¦ä¸² slice çš„å·¥ä½œæ–¹å¼ä¸€æ ·ï¼Œé€šè¿‡å­˜å‚¨ç¬¬ä¸€ä¸ªé›†åˆå…ƒç´ çš„å¼•ç”¨å’Œä¸€ä¸ªé›†åˆæ€»é•¿åº¦ã€‚ä½ å¯ä»¥å¯¹å…¶ä»–æ‰€æœ‰é›†åˆä½¿ç”¨è¿™ç±» sliceã€‚ç¬¬å…«ç« è®²åˆ° vector æ—¶ä¼šè¯¦ç»†è®¨è®ºè¿™äº›é›†åˆã€‚
  
  

### ç»“æ„ä½“

```rust
struct User {
    active: bool,
    username: String,
    email: String,
    sign_in_count: u64,
}
```
é€šè¿‡ä¸ºæ¯ä¸ªå­—æ®µæŒ‡å®šå…·ä½“å€¼æ¥åˆ›å»ºè¿™ä¸ªç»“æ„ä½“çš„å®ä¾‹ã€‚åˆ›å»ºä¸€ä¸ªå®ä¾‹éœ€è¦ä»¥ç»“æ„ä½“çš„åå­—å¼€å¤´ï¼Œæ¥ç€åœ¨å¤§æ‹¬å·ä¸­ä½¿ç”¨ key: value é”® - å€¼å¯¹çš„å½¢å¼æä¾›å­—æ®µã€‚å®ä¾‹ä¸­å­—æ®µçš„é¡ºåºä¸éœ€è¦å’Œå®ƒä»¬åœ¨ç»“æ„ä½“ä¸­å£°æ˜çš„é¡ºåºä¸€è‡´ã€‚
```rust
fn main() {
    let mut user1 = User {
        active: true,
        username: String::from("someusername123"),
        email: String::from("someone@example.com"),
        sign_in_count: 1,
    };
    
    user1.email = String::from("anotheremail@example.com");
}
```

æ³¨æ„å¯å˜æ€§å¿…é¡»ä½œç”¨åœ¨æ•´ä¸ªå®ä¾‹ï¼›Rust å¹¶ä¸å…è®¸åªå°†æŸä¸ªå­—æ®µæ ‡è®°ä¸ºå¯å˜ã€‚

#### ä½¿ç”¨å­—æ®µåˆå§‹åŒ–

`build_user` å‡½æ•°è·å– email å’Œç”¨æˆ·åå¹¶è¿”å› `User` å®ä¾‹ï¼š

```rust
fn build_user(email: String, username: String) -> User {
    User {
        active: true,
        username: username,
        email: email,
        sign_in_count: 1,
    }
}
```

ä¸ºå‡½æ•°å‚æ•°èµ·ä¸ç»“æ„ä½“å­—æ®µç›¸åŒçš„åå­—æ˜¯å¯ä»¥ç†è§£çš„ï¼Œä½†æ˜¯ä¸å¾—ä¸é‡å¤ `email` å’Œ `username` å­—æ®µåç§°ä¸å˜é‡æœ‰äº›å•°å—¦ã€‚å¦‚æœç»“æ„ä½“æœ‰æ›´å¤šå­—æ®µï¼Œé‡å¤æ¯ä¸ªåç§°å°±æ›´åŠ çƒ¦äººäº†ã€‚å¹¸è¿çš„æ˜¯ï¼Œæœ‰ä¸€ä¸ªæ–¹ä¾¿çš„ç®€å†™è¯­æ³•ï¼Œ **å­—æ®µåˆå§‹åŒ–ç®€å†™è¯­æ³•**ï¼š

```rust
fn build_user(email: String, username: String) -> User {
    User {
        active: true,
        username,
        email,
        sign_in_count: 1,
    }
}
```

#### ä½¿ç”¨ç»“æ„ä½“æ›´æ–°è¯­æ³•

ä½¿ç”¨æ—§å®ä¾‹çš„å¤§éƒ¨åˆ†å€¼ä½†æ”¹å˜å…¶éƒ¨åˆ†å€¼æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç»“æ„ä½“å®ä¾‹é€šå¸¸æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚è¿™å¯ä»¥é€šè¿‡ **ç»“æ„ä½“æ›´æ–°è¯­æ³•**ï¼ˆ*struct update syntax*ï¼‰å®ç°ã€‚

ä¸‹é¢æ¼”ç¤ºäº†å¦‚ä½•åœ¨ `user2` ä¸­åˆ›å»ºä¸€ä¸ªæ–° `User` å®ä¾‹ã€‚æˆ‘ä»¬ä¸º `email` è®¾ç½®äº†æ–°çš„å€¼ï¼Œå…¶ä»–å€¼åˆ™ä½¿ç”¨äº†å®ä¾‹ 5-2 ä¸­åˆ›å»ºçš„ `user1` ä¸­çš„åŒåå€¼ï¼š

```rust
fn main() {
    // --snip--

    let user2 = User {
        active: user1.active,
        username: user1.username,
        email: String::from("another@example.com"),
        sign_in_count: user1.sign_in_count,
    };
}
```

ä½¿ç”¨ç»“æ„ä½“æ›´æ–°è¯­æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ›´å°‘çš„ä»£ç æ¥è¾¾åˆ°ç›¸åŒçš„æ•ˆæœï¼Œå¦‚ç¤ºä¾‹ 5-7 æ‰€ç¤ºã€‚`..` è¯­æ³•æŒ‡å®šäº†å‰©ä½™æœªæ˜¾å¼è®¾ç½®å€¼çš„å­—æ®µåº”æœ‰ä¸ç»™å®šå®ä¾‹å¯¹åº”å­—æ®µç›¸åŒçš„å€¼ã€‚  

```rust
fn main() {
    // --snip--

    let user2 = User {
        email: String::from("another@example.com"),
        ..user1
    };
}
```

ğŸ§æ³¨æ„ï¼Œç»“æ„æ›´æ–°è¯­æ³•å°±åƒå¸¦æœ‰ `=` çš„èµ‹å€¼ï¼Œå› ä¸ºå®ƒç§»åŠ¨äº†æ•°æ®ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ€»ä½“ä¸Šè¯´æˆ‘ä»¬åœ¨åˆ›å»º `user2` åä¸èƒ½å°±å†ä½¿ç”¨ `user1` äº†ï¼Œå› ä¸º `user1` çš„ `username` å­—æ®µä¸­çš„ `String` è¢«ç§»åˆ° `user2` ä¸­ã€‚å¦‚æœæˆ‘ä»¬ç»™ `user2` çš„ `email` å’Œ `username` éƒ½èµ‹äºˆæ–°çš„ `String` å€¼ï¼Œä»è€Œåªä½¿ç”¨ `user1` çš„ `active` å’Œ `sign_in_count` å€¼ï¼Œé‚£ä¹ˆ `user1` åœ¨åˆ›å»º `user2` åä»ç„¶æœ‰æ•ˆã€‚

#### å…ƒç»„ç»“æ„ä½“

å¯ä»¥å®šä¹‰ä¸å…ƒç»„ç±»ä¼¼çš„ç»“æ„ä½“ï¼Œç§°ä¸º **å…ƒç»„ç»“æ„ä½“**ï¼ˆ*tuple structs*ï¼‰ã€‚å…ƒç»„ç»“æ„ä½“æœ‰ç€ç»“æ„ä½“åç§°æä¾›çš„å«ä¹‰ï¼Œä½†æ²¡æœ‰å…·ä½“çš„å­—æ®µåï¼Œåªæœ‰å­—æ®µçš„ç±»å‹ã€‚å½“ä½ æƒ³ç»™æ•´ä¸ªå…ƒç»„å–ä¸€ä¸ªåå­—ï¼Œå¹¶ä½¿å…ƒç»„æˆä¸ºä¸å…¶ä»–å…ƒç»„ä¸åŒçš„ç±»å‹æ—¶ï¼Œå…ƒç»„ç»“æ„ä½“æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œè¿™æ—¶åƒå¸¸è§„ç»“æ„ä½“é‚£æ ·ä¸ºæ¯ä¸ªå­—æ®µå‘½åå°±æ˜¾å¾—å¤šä½™å’Œå½¢å¼åŒ–äº†ã€‚

è¦å®šä¹‰å…ƒç»„ç»“æ„ä½“ï¼Œä»¥ `struct` å…³é”®å­—å’Œç»“æ„ä½“åå¼€å¤´å¹¶åè·Ÿå…ƒç»„ä¸­çš„ç±»å‹ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢æ˜¯ä¸¤ä¸ªåˆ†åˆ«å«åš `Color` å’Œ `Point` å…ƒç»„ç»“æ„ä½“çš„å®šä¹‰å’Œç”¨æ³•ï¼š

```rust
struct Color(i32, i32, i32);
struct Point(i32, i32, i32);

fn main() {
    let black = Color(0, 0, 0);
    let origin = Point(0, 0, 0);
}
```

#### ç±»å•å…ƒç»“æ„ä½“

æˆ‘ä»¬ä¹Ÿå¯ä»¥å®šä¹‰ä¸€ä¸ªæ²¡æœ‰ä»»ä½•å­—æ®µçš„ç»“æ„ä½“ï¼å®ƒä»¬è¢«ç§°ä¸º **ç±»å•å…ƒç»“æ„ä½“**ï¼ˆ*unit-like structs*ï¼‰ç±»ä¼¼äº `()`ã€‚

```rust
struct AlwaysEqual;

fn main() {
    let subject = AlwaysEqual;
}
```

#### ç»“æ„ä½“æ•°æ®çš„æ‰€æœ‰æƒ

åœ¨ `User` ç»“æ„ä½“çš„å®šä¹‰ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†è‡ªèº«æ‹¥æœ‰æ‰€æœ‰æƒçš„ `String` ç±»å‹è€Œä¸æ˜¯ `&str` å­—ç¬¦ä¸² slice ç±»å‹ã€‚è¿™æ˜¯ä¸€ä¸ªæœ‰æ„è€Œä¸ºä¹‹çš„é€‰æ‹©ï¼Œå› ä¸ºæˆ‘ä»¬æƒ³è¦è¿™ä¸ªç»“æ„ä½“æ‹¥æœ‰å®ƒæ‰€æœ‰çš„æ•°æ®ï¼Œä¸ºæ­¤åªè¦æ•´ä¸ªç»“æ„ä½“æ˜¯æœ‰æ•ˆçš„è¯å…¶æ•°æ®ä¹Ÿæ˜¯æœ‰æ•ˆçš„ã€‚

å¯ä»¥ä½¿ç»“æ„ä½“å­˜å‚¨è¢«å…¶ä»–å¯¹è±¡æ‹¥æœ‰çš„æ•°æ®çš„å¼•ç”¨ï¼Œä¸è¿‡è¿™ä¹ˆåšçš„è¯éœ€è¦ç”¨ä¸Š **ç”Ÿå‘½å‘¨æœŸ**ï¼ˆ*lifetimes*ï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªç¬¬åç« ä¼šè®¨è®ºçš„ Rust åŠŸèƒ½ã€‚ç”Ÿå‘½å‘¨æœŸç¡®ä¿ç»“æ„ä½“å¼•ç”¨çš„æ•°æ®æœ‰æ•ˆæ€§è·Ÿç»“æ„ä½“æœ¬èº«ä¿æŒä¸€è‡´ã€‚å¦‚æœä½ å°è¯•åœ¨ç»“æ„ä½“ä¸­å­˜å‚¨ä¸€ä¸ªå¼•ç”¨è€Œä¸æŒ‡å®šç”Ÿå‘½å‘¨æœŸå°†æ˜¯æ— æ•ˆçš„ï¼Œæ¯”å¦‚è¿™æ ·ï¼š

```rust
struct User {
    active: bool,
    username: &str,
    email: &str,
    sign_in_count: u64,
}

fn main() {
    let user1 = User {
        active: true,
        username: "someusername123",
        email: "someone@example.com",
        sign_in_count: 1,
    };
}
```

ç¼–è¯‘å™¨ä¼šæŠ±æ€¨å®ƒéœ€è¦ç”Ÿå‘½å‘¨æœŸæ ‡è¯†ç¬¦ï¼š

```console
$ cargo run
   Compiling structs v0.1.0 (file:///projects/structs)
error[E0106]: missing lifetime specifier
 --> src/main.rs:3:15
  |
3 |     username: &str,
  |               ^ expected named lifetime parameter
  |
help: consider introducing a named lifetime parameter
  |
1 ~ struct User<'a> {
2 |     active: bool,
3 ~     username: &'a str,
  |

error[E0106]: missing lifetime specifier
 --> src/main.rs:4:12
  |
4 |     email: &str,
  |            ^ expected named lifetime parameter
  |
help: consider introducing a named lifetime parameter
  |
1 ~ struct User<'a> {
2 |     active: bool,
3 |     username: &str,
4 ~     email: &'a str,
  |

For more information about this error, try `rustc --explain E0106`.
error: could not compile `structs` due to 2 previous errors
```

ç¬¬åç« ä¼šè®²åˆ°å¦‚ä½•ä¿®å¤è¿™ä¸ªé—®é¢˜ä»¥ä¾¿åœ¨ç»“æ„ä½“ä¸­å­˜å‚¨å¼•ç”¨ï¼Œä¸è¿‡ç°åœ¨ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨åƒ `String` è¿™ç±»æ‹¥æœ‰æ‰€æœ‰æƒçš„ç±»å‹æ¥æ›¿ä»£ `&str` è¿™æ ·çš„å¼•ç”¨ä»¥ä¿®æ­£è¿™ä¸ªé”™è¯¯ã€‚

#### é€šè¿‡æ´¾ç”Ÿ trait å¢åŠ å®ç”¨åŠŸèƒ½ğŸ§

åœ¨è°ƒè¯•ç¨‹åºæ—¶æ‰“å°å‡º `Rectangle` å®ä¾‹æ¥æŸ¥çœ‹å…¶æ‰€æœ‰å­—æ®µçš„å€¼éå¸¸æœ‰ç”¨ã€‚ç¤ºä¾‹åƒå‰é¢ç« èŠ‚é‚£æ ·å°è¯•ä½¿ç”¨ [`println!` å®](https://doc.rust-lang.org/std/macro.println.html)ã€‚ä½†è¿™å¹¶ä¸è¡Œã€‚

```rust
struct Rectangle {
    width: u32,
    height: u32,
}

fn main() {
    let rect1 = Rectangle {
        width: 30,
        height: 50,
    };

    println!("rect1 is {}", rect1);
}
```

å½“æˆ‘ä»¬è¿è¡Œè¿™ä¸ªä»£ç æ—¶ï¼Œä¼šå‡ºç°å¸¦æœ‰å¦‚ä¸‹æ ¸å¿ƒä¿¡æ¯çš„é”™è¯¯ï¼š

```text
error[E0277]: `Rectangle` doesn't implement `std::fmt::Display`
```

`println!` å®èƒ½å¤„ç†å¾ˆå¤šç±»å‹çš„æ ¼å¼ï¼Œ**ä½†`{}` é»˜è®¤å‘Šè¯‰ `println!` ä½¿ç”¨è¢«ç§°ä¸º `Display` çš„æ ¼å¼**ï¼Œç»“æ„ä½“å¹¶æ²¡æœ‰æä¾›ä¸€ä¸ªé»˜è®¤`Display` å®ç°æ¥ä½¿ç”¨ `println!` ä¸ `{}` å ä½ç¬¦ã€‚

ä½†æ˜¯å¦‚æœæˆ‘ä»¬ç»§ç»­é˜…è¯»é”™è¯¯ï¼Œå°†ä¼šå‘ç°è¿™ä¸ªæœ‰å¸®åŠ©çš„ä¿¡æ¯ï¼š

```text
= help: the trait `std::fmt::Display` is not implemented for `Rectangle`
= note: in format strings you may be able to use `{:?}` (or {:#?} for pretty-print) instead
```

**`{:?}` æŒ‡ç¤ºç¬¦å‘Šè¯‰ `println!` æˆ‘ä»¬æƒ³è¦ä½¿ç”¨å«åš `Debug` çš„è¾“å‡ºæ ¼å¼**ã€‚`Debug` æ˜¯ä¸€ä¸ª traitï¼Œå®ƒå…è®¸æˆ‘ä»¬ä»¥ä¸€ç§å¯¹å¼€å‘è€…æœ‰å¸®åŠ©çš„æ–¹å¼æ‰“å°ç»“æ„ä½“ï¼Œä»¥ä¾¿å½“æˆ‘ä»¬è°ƒè¯•ä»£ç æ—¶èƒ½çœ‹åˆ°å®ƒçš„å€¼ã€‚

è¿™æ ·è°ƒæ•´åå†æ¬¡è¿è¡Œç¨‹åºã€‚è§é¬¼äº†ï¼ä»ç„¶èƒ½çœ‹åˆ°ä¸€ä¸ªé”™è¯¯ï¼š

```text
error[E0277]: `Rectangle` doesn't implement `Debug`
```

ä¸è¿‡ç¼–è¯‘å™¨åˆä¸€æ¬¡ç»™å‡ºäº†ä¸€ä¸ªæœ‰å¸®åŠ©çš„ä¿¡æ¯ï¼š

```text
   = help: the trait `Debug` is not implemented for `Rectangle`
   = note: add `#[derive(Debug)]` to `Rectangle` or manually `impl Debug for Rectangle`
```

Rustç¡®å®åŒ…å«äº†æ‰“å°å‡ºè°ƒè¯•ä¿¡æ¯çš„åŠŸèƒ½ï¼Œä¸è¿‡æˆ‘ä»¬å¿…é¡»ä¸ºç»“æ„ä½“æ˜¾å¼é€‰æ‹©è¿™ä¸ªåŠŸèƒ½ã€‚**ä¸ºæ­¤ï¼Œåœ¨ç»“æ„ä½“å®šä¹‰ä¹‹å‰åŠ ä¸Šå¤–éƒ¨å±æ€§ `#[derive(Debug)]`**ï¼Œ

æ–‡ä»¶åï¼šsrc/main.rs

```rust
#[derive(Debug)]
struct Rectangle {
    width: u32,
    height: u32,
}

fn main() {
    let rect1 = Rectangle {
        width: 30,
        height: 50,
    };

    println!("rect1 is {:?}", rect1);
}
```

ç°åœ¨æˆ‘ä»¬å†è¿è¡Œè¿™ä¸ªç¨‹åºæ—¶ï¼Œå°±ä¸ä¼šæœ‰ä»»ä½•é”™è¯¯ï¼Œå¹¶ä¼šå‡ºç°å¦‚ä¸‹è¾“å‡ºï¼š

```console
rect1 is Rectangle { width: 30, height: 50 }
```

å½“æˆ‘ä»¬æœ‰ä¸€ä¸ªæ›´å¤§çš„ç»“æ„ä½“æ—¶ï¼Œèƒ½æœ‰æ›´æ˜“è¯»ä¸€ç‚¹çš„è¾“å‡ºå°±å¥½äº†ï¼Œ**ä¸ºæ­¤å¯ä»¥ä½¿ç”¨ `{:#?}` æ›¿æ¢ `println!` å­—ç¬¦ä¸²ä¸­çš„ `{:?}`å¢åŠ å¯è¯»æ€§ã€‚**åœ¨è¿™ä¸ªä¾‹å­ä¸­ä½¿ç”¨ `{:#?}` é£æ ¼å°†ä¼šè¾“å‡ºå¦‚ä¸‹ï¼š

```console
rect1 is Rectangle {
    width: 30,
    height: 50,
}
```

å¦ä¸€ç§ä½¿ç”¨ `Debug` æ ¼å¼æ‰“å°æ•°å€¼çš„æ–¹æ³•æ˜¯ä½¿ç”¨ [`dbg!` å®](https://doc.rust-lang.org/std/macro.dbg.html)ã€‚`dbg!` å®æ¥æ”¶ä¸€ä¸ªè¡¨è¾¾å¼çš„æ‰€æœ‰æƒï¼ˆä¸ `println!` å®ç›¸åï¼Œåè€…æ¥æ”¶çš„æ˜¯å¼•ç”¨ï¼‰ï¼Œæ‰“å°å‡ºä»£ç ä¸­è°ƒç”¨ dbg! å®æ—¶æ‰€åœ¨çš„æ–‡ä»¶å’Œè¡Œå·ï¼Œä»¥åŠè¯¥è¡¨è¾¾å¼çš„ç»“æœå€¼ï¼Œ**å¹¶è¿”å›è¯¥å€¼çš„æ‰€æœ‰æƒ**ã€‚

> æ³¨æ„ï¼šè°ƒç”¨ `dbg!` å®ä¼šæ‰“å°åˆ°æ ‡å‡†é”™è¯¯æ§åˆ¶å°æµï¼ˆ`stderr`ï¼‰ï¼Œä¸ `println!` ä¸åŒï¼Œåè€…ä¼šæ‰“å°åˆ°æ ‡å‡†è¾“å‡ºæ§åˆ¶å°æµï¼ˆ`stdout`ï¼‰ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯¹åˆ†é…ç»™ `width` å­—æ®µçš„å€¼ä»¥åŠ `rect1` ä¸­æ•´ä¸ªç»“æ„çš„å€¼æ„Ÿå…´è¶£ã€‚

```rust
#[derive(Debug)]
struct Rectangle {
    width: u32,
    height: u32,
}

fn main() {
    let scale = 2;
    let rect1 = Rectangle {
        width: dbg!(30 * scale),
        height: 50,
    };

    dbg!(&rect1);
}
```

æˆ‘ä»¬å¯ä»¥æŠŠ `dbg!` æ”¾åœ¨è¡¨è¾¾å¼ `30 * scale` å‘¨å›´ï¼Œå› ä¸º `dbg!` è¿”å›è¡¨è¾¾å¼çš„å€¼çš„æ‰€æœ‰æƒï¼Œæ‰€ä»¥ `width` å­—æ®µå°†è·å¾—ç›¸åŒçš„å€¼ï¼Œå°±åƒæˆ‘ä»¬åœ¨é‚£é‡Œæ²¡æœ‰ `dbg!` è°ƒç”¨ä¸€æ ·ã€‚æˆ‘ä»¬ä¸å¸Œæœ› `dbg!` æ‹¥æœ‰ `rect1` çš„æ‰€æœ‰æƒï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ä¸‹ä¸€æ¬¡è°ƒç”¨ `dbg!` æ—¶ä¼ é€’ä¸€ä¸ªå¼•ç”¨ã€‚ä¸‹é¢æ˜¯è¿™ä¸ªä¾‹å­çš„è¾“å‡ºç»“æœï¼š

```console
[src/main.rs:10] 30 * scale = 60
[src/main.rs:14] &rect1 = Rectangle {
    width: 60,
    height: 50,
}
```

#### æ–¹æ³•

```rust
#[derive(Debug)]
struct Rectangle {
    width: u32,
    height: u32,
}

impl Rectangle {
    fn area(&self) -> u32 {
        self.width * self.height
    }
    
    fn can_hold(&self, other: &Rectangle) -> bool {
        self.width > other.width && self.height > other.height
    }
}

fn main() {
    let rect1 = Rectangle {
        width: 30,
        height: 50,
    };

    println!(
        "The area of the rectangle is {} square pixels.",
        rect1.area()
    );
}
```

ä¸ºäº†ä½¿å‡½æ•°å®šä¹‰äº `Rectangle` çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œæˆ‘ä»¬å¼€å§‹äº†ä¸€ä¸ª `impl` å—ï¼Œè¿™ä¸ª `impl` å—ä¸­çš„æ‰€æœ‰å†…å®¹éƒ½å°†ä¸ `Rectangle` ç±»å‹ç›¸å…³è”ã€‚æ¥ç€å°† `area` å‡½æ•°ç§»åŠ¨åˆ° `impl` å¤§æ‹¬å·ä¸­ï¼Œå¹¶å°†ç­¾åä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°å’Œå‡½æ•°ä½“ä¸­å…¶ä»–åœ°æ–¹çš„å¯¹åº”å‚æ•°æ”¹æˆ `self`ã€‚

åœ¨ `area` çš„ç­¾åä¸­ï¼Œä½¿ç”¨ `&self` æ¥æ›¿ä»£ `rectangle: &Rectangle`ï¼Œ`&self` å®é™…ä¸Šæ˜¯ `self: &Self` çš„ç¼©å†™ã€‚åœ¨ä¸€ä¸ª `impl` å—ä¸­ï¼Œ`Self` ç±»å‹æ˜¯ `impl` å—çš„ç±»å‹çš„åˆ«åã€‚æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æœ‰ä¸€ä¸ªåä¸º `self` çš„`Self` ç±»å‹çš„å‚æ•°ï¼Œæ‰€ä»¥ Rust è®©ä½ åœ¨ç¬¬ä¸€ä¸ªå‚æ•°ä½ç½®ä¸Šåªç”¨ `self` è¿™ä¸ªåå­—æ¥ç¼©å†™ã€‚æ³¨æ„ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦åœ¨ `self` å‰é¢ä½¿ç”¨ `&` æ¥è¡¨ç¤ºè¿™ä¸ªæ–¹æ³•å€Ÿç”¨äº† `Self` å®ä¾‹ã€‚æ–¹æ³•å¯ä»¥é€‰æ‹©è·å¾— `self` çš„æ‰€æœ‰æƒï¼Œæˆ–è€…åƒæˆ‘ä»¬è¿™é‡Œä¸€æ ·ä¸å¯å˜åœ°å€Ÿç”¨ `self`ï¼Œæˆ–è€…å¯å˜åœ°å€Ÿç”¨ `self`ï¼Œå°±è·Ÿå…¶ä»–å‚æ•°ä¸€æ ·ã€‚

#### è‡ªåŠ¨å¼•ç”¨å’Œè§£å¼•ç”¨ğŸ§

åœ¨ C/C++ è¯­è¨€ä¸­ï¼Œæœ‰ä¸¤ä¸ªä¸åŒçš„è¿ç®—ç¬¦æ¥è°ƒç”¨æ–¹æ³•ï¼š`.` ç›´æ¥åœ¨å¯¹è±¡ä¸Šè°ƒç”¨æ–¹æ³•ï¼Œè€Œ `->` åœ¨ä¸€ä¸ªå¯¹è±¡çš„æŒ‡é’ˆä¸Šè°ƒç”¨æ–¹æ³•ï¼Œè¿™æ—¶éœ€è¦å…ˆè§£å¼•ç”¨ï¼ˆdereferenceï¼‰æŒ‡é’ˆã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœ `object` æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œé‚£ä¹ˆ `object->something()` å°±åƒ `(*object).something()` ä¸€æ ·ã€‚

Rust å¹¶æ²¡æœ‰ä¸€ä¸ªä¸ `->` ç­‰æ•ˆçš„è¿ç®—ç¬¦ï¼›ç›¸åï¼ŒRust æœ‰ä¸€ä¸ªå« **è‡ªåŠ¨å¼•ç”¨å’Œè§£å¼•ç”¨**ï¼ˆ*automatic referencing and dereferencing*ï¼‰çš„åŠŸèƒ½ã€‚æ–¹æ³•è°ƒç”¨æ˜¯ Rust ä¸­å°‘æ•°å‡ ä¸ªæ‹¥æœ‰è¿™ç§è¡Œä¸ºçš„åœ°æ–¹ã€‚

å®ƒæ˜¯è¿™æ ·å·¥ä½œçš„ï¼šå½“ä½¿ç”¨ `object.something()` è°ƒç”¨æ–¹æ³•æ—¶ï¼ŒRust ä¼šè‡ªåŠ¨ä¸º `object` æ·»åŠ  `&`ã€`&mut` æˆ– `*` ä»¥ä¾¿ä½¿ `object` ä¸æ–¹æ³•ç­¾ååŒ¹é…ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™äº›ä»£ç æ˜¯ç­‰ä»·çš„ï¼š

```rust
p1.distance(&p2);
(&p1).distance(&p2);
```

ç¬¬ä¸€è¡Œçœ‹èµ·æ¥ç®€æ´çš„å¤šã€‚è¿™ç§è‡ªåŠ¨å¼•ç”¨çš„è¡Œä¸ºä¹‹æ‰€ä»¥æœ‰æ•ˆï¼Œæ˜¯å› ä¸ºæ–¹æ³•æœ‰ä¸€ä¸ªæ˜ç¡®çš„æ¥æ”¶è€…â€”â€”â€”â€” `self` çš„ç±»å‹ã€‚åœ¨ç»™å‡ºæ¥æ”¶è€…å’Œæ–¹æ³•åçš„å‰æä¸‹ï¼ŒRust å¯ä»¥æ˜ç¡®åœ°è®¡ç®—å‡ºæ–¹æ³•æ˜¯ä»…ä»…è¯»å–ï¼ˆ`&self`ï¼‰ï¼Œåšå‡ºä¿®æ”¹ï¼ˆ`&mut self`ï¼‰æˆ–è€…æ˜¯è·å–æ‰€æœ‰æƒï¼ˆ`self`ï¼‰ã€‚äº‹å®ä¸Šï¼ŒRust å¯¹æ–¹æ³•æ¥æ”¶è€…çš„éšå¼å€Ÿç”¨è®©æ‰€æœ‰æƒåœ¨å®è·µä¸­æ›´å‹å¥½ã€‚

#### æ„é€ å‡½æ•°

æ‰€æœ‰åœ¨ `impl` å—ä¸­å®šä¹‰çš„å‡½æ•°è¢«ç§°ä¸º **å…³è”å‡½æ•°**ï¼ˆ*associated functions*ï¼‰ï¼Œå› ä¸ºå®ƒä»¬ä¸ `impl` åé¢å‘½åçš„ç±»å‹ç›¸å…³ã€‚æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸ä»¥ `self` ä¸ºç¬¬ä¸€å‚æ•°çš„å…³è”å‡½æ•°ï¼ˆå› æ­¤ä¸æ˜¯æ–¹æ³•ï¼‰ï¼Œå› ä¸ºå®ƒä»¬å¹¶ä¸ä½œç”¨äºä¸€ä¸ªç»“æ„ä½“çš„å®ä¾‹ã€‚æˆ‘ä»¬å·²ç»ä½¿ç”¨äº†ä¸€ä¸ªè¿™æ ·çš„å‡½æ•°ï¼šåœ¨ `String` ç±»å‹ä¸Šå®šä¹‰çš„ `String::from` å‡½æ•°ã€‚

ä¸æ˜¯æ–¹æ³•çš„å…³è”å‡½æ•°ç»å¸¸è¢«ç”¨ä½œè¿”å›ä¸€ä¸ªç»“æ„ä½“æ–°å®ä¾‹çš„æ„é€ å‡½æ•°ã€‚è¿™äº›å‡½æ•°çš„åç§°é€šå¸¸ä¸º `new` ï¼Œä½† `new` å¹¶ä¸æ˜¯ä¸€ä¸ªå…³é”®å­—ã€‚ä¾‹å¦‚æˆ‘ä»¬å¯ä»¥æä¾›ä¸€ä¸ªå«åš `square` å…³è”å‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªç»´åº¦å‚æ•°å¹¶ä¸”åŒæ—¶ä½œä¸ºå®½å’Œé«˜ï¼Œè¿™æ ·å¯ä»¥æ›´è½»æ¾çš„åˆ›å»ºä¸€ä¸ªæ­£æ–¹å½¢ `Rectangle` è€Œä¸å¿…æŒ‡å®šä¸¤æ¬¡åŒæ ·çš„å€¼ï¼š

æ–‡ä»¶åï¼šsrc/main.rs

```rust
impl Rectangle {
    fn square(size: u32) -> Self {
        Self {
            width: size,
            height: size,
        }
    }
}
```

å…³é”®å­— `Self` åœ¨å‡½æ•°çš„è¿”å›ç±»å‹ä¸­ä»£æŒ‡åœ¨ `impl` å…³é”®å­—åå‡ºç°çš„ç±»å‹ï¼Œåœ¨è¿™é‡Œæ˜¯ `Rectangle`

ä½¿ç”¨ç»“æ„ä½“åå’Œ `::` è¯­æ³•æ¥è°ƒç”¨è¿™ä¸ªå…³è”å‡½æ•°ï¼šæ¯”å¦‚ `let sq = Rectangle::square(3);`ã€‚è¿™ä¸ªå‡½æ•°ä½äºç»“æ„ä½“çš„å‘½åç©ºé—´ä¸­ï¼š`::` è¯­æ³•ç”¨äºå…³è”å‡½æ•°å’Œæ¨¡å—åˆ›å»ºçš„å‘½åç©ºé—´ã€‚

### æšä¸¾

#### enumæšä¸¾

å¯ä»¥é€šè¿‡åœ¨ä»£ç ä¸­å®šä¹‰ä¸€ä¸ª `IpAddrKind` æšä¸¾æ¥è¡¨ç°è¿™ä¸ªæ¦‚å¿µå¹¶åˆ—å‡ºå¯èƒ½çš„ IP åœ°å€ç±»å‹ï¼Œ`V4` å’Œ `V6`ã€‚è¿™è¢«ç§°ä¸ºæšä¸¾çš„ **æˆå‘˜**ï¼ˆ*variants*ï¼‰ï¼š

```rust
enum IpAddrKind {
    V4,
    V6,
}
```

ç°åœ¨ `IpAddrKind` å°±æ˜¯ä¸€ä¸ªå¯ä»¥åœ¨ä»£ç ä¸­ä½¿ç”¨çš„è‡ªå®šä¹‰æ•°æ®ç±»å‹äº†ã€‚

å¯ä»¥åƒè¿™æ ·åˆ›å»º `IpAddrKind` ä¸¤ä¸ªä¸åŒæˆå‘˜çš„å®ä¾‹ï¼š

```rust
    let four = IpAddrKind::V4;
    let six = IpAddrKind::V6;
```

æˆ‘ä»¬è¿˜å¯ä»¥ç›´æ¥å°†æ•°æ®é™„åŠ åˆ°æšä¸¾çš„æ¯ä¸ªæˆå‘˜ä¸Šï¼Œè¿™æ ·å°±ä¸éœ€è¦ä¸€ä¸ªé¢å¤–çš„ç»“æ„ä½“äº†ã€‚è¿™é‡Œä¹Ÿå¾ˆå®¹æ˜“çœ‹å‡ºæšä¸¾å·¥ä½œçš„å¦ä¸€ä¸ªç»†èŠ‚ï¼šæ¯ä¸€ä¸ªæˆ‘ä»¬å®šä¹‰çš„æšä¸¾æˆå‘˜çš„åå­—ä¹Ÿå˜æˆäº†ä¸€ä¸ªæ„å»ºæšä¸¾çš„å®ä¾‹çš„å‡½æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ`IpAddr::V4()` æ˜¯ä¸€ä¸ªè·å– `String` å‚æ•°å¹¶è¿”å› `IpAddr` ç±»å‹å®ä¾‹çš„å‡½æ•°è°ƒç”¨ã€‚ä½œä¸ºå®šä¹‰æšä¸¾çš„ç»“æœï¼Œè¿™äº›æ„é€ å‡½æ•°ä¼šè‡ªåŠ¨è¢«å®šä¹‰ã€‚

`IpAddr` æšä¸¾çš„æ–°å®šä¹‰è¡¨æ˜äº† `V4` å’Œ `V6` æˆå‘˜éƒ½å…³è”äº† `String` å€¼ï¼š

```rust
    enum IpAddr {
        V4(String),
        V6(String),
    }

    let home = IpAddr::V4(String::from("127.0.0.1"));

    let loopback = IpAddr::V6(String::from("::1"));
```

ç”¨æšä¸¾æ›¿ä»£ç»“æ„ä½“è¿˜æœ‰å¦ä¸€ä¸ªä¼˜åŠ¿ï¼šæ¯ä¸ªæˆå‘˜å¯ä»¥å¤„ç†ä¸åŒç±»å‹å’Œæ•°é‡çš„æ•°æ®ã€‚IPv4 ç‰ˆæœ¬çš„ IP åœ°å€æ€»æ˜¯å«æœ‰å››ä¸ªå€¼åœ¨ 0 å’Œ 255 ä¹‹é—´çš„æ•°å­—éƒ¨åˆ†ã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦å°† `V4` åœ°å€å­˜å‚¨ä¸ºå››ä¸ª `u8` å€¼è€Œ `V6` åœ°å€ä»ç„¶è¡¨ç°ä¸ºä¸€ä¸ª `String`ï¼Œè¿™å°±ä¸èƒ½ä½¿ç”¨ç»“æ„ä½“äº†ã€‚æšä¸¾åˆ™å¯ä»¥è½»æ˜“çš„å¤„ç†è¿™ä¸ªæƒ…å†µï¼š

```rust
    enum IpAddr {
        V4(u8, u8, u8, u8),
        V6(String),
    }

    let home = IpAddr::V4(127, 0, 0, 1);

    let loopback = IpAddr::V6(String::from("::1"));
```

æˆ‘ä»¬å¯ä»¥å°†ä»»æ„ç±»å‹çš„æ•°æ®æ”¾å…¥æšä¸¾æˆå‘˜ä¸­ï¼šä¾‹å¦‚å­—ç¬¦ä¸²ã€æ•°å­—ç±»å‹æˆ–è€…ç»“æ„ä½“ã€‚ç”šè‡³å¯ä»¥åŒ…å«å¦ä¸€ä¸ªæšä¸¾ï¼

```rust
enum Message {
    Quit,
    Move { x: i32, y: i32 },
    Write(String),
    ChangeColor(i32, i32, i32),
}
```

ç»“æ„ä½“å’Œæšä¸¾è¿˜æœ‰å¦ä¸€ä¸ªç›¸ä¼¼ç‚¹ï¼šå°±åƒå¯ä»¥ä½¿ç”¨ `impl` æ¥ä¸ºç»“æ„ä½“å®šä¹‰æ–¹æ³•é‚£æ ·ï¼Œä¹Ÿå¯ä»¥åœ¨æšä¸¾ä¸Šå®šä¹‰æ–¹æ³•ã€‚è¿™æ˜¯ä¸€ä¸ªå®šä¹‰äºæˆ‘ä»¬ `Message` æšä¸¾ä¸Šçš„å«åš `call` çš„æ–¹æ³•ï¼š

```rust
enum Message {
    Quit,
    Move { x: i32, y: i32 },
    Write(String),
    ChangeColor(i32, i32, i32),
}    

impl Message {
    fn call(&self) {
       // åœ¨è¿™é‡Œå®šä¹‰æ–¹æ³•ä½“
    }
}

let m = Message::Write(String::from("hello"));
m.call();
```

æ–¹æ³•ä½“ä½¿ç”¨äº† `self` æ¥è·å–è°ƒç”¨æ–¹æ³•çš„å€¼ã€‚è¿™ä¸ªä¾‹å­ä¸­ï¼Œåˆ›å»ºäº†ä¸€ä¸ªå€¼ä¸º `Message::Write(String::from("hello"))` çš„å˜é‡ `m`ï¼Œè€Œä¸”è¿™å°±æ˜¯å½“ `m.call()` è¿è¡Œæ—¶ `call` æ–¹æ³•ä¸­çš„ `self` çš„å€¼ã€‚

#### Optionæšä¸¾ğŸ§

`Option` æ˜¯æ ‡å‡†åº“å®šä¹‰çš„å¦ä¸€ä¸ªæšä¸¾ã€‚`Option` ç±»å‹åº”ç”¨å¹¿æ³›å› ä¸ºå®ƒç¼–ç äº†ä¸€ä¸ªéå¸¸æ™®éçš„åœºæ™¯ï¼Œå³ä¸€ä¸ªå€¼è¦ä¹ˆæœ‰å€¼è¦ä¹ˆæ²¡å€¼ã€‚

ğŸ§**Rust å¹¶æ²¡æœ‰å¾ˆå¤šå…¶ä»–è¯­è¨€ä¸­æœ‰çš„ç©ºå€¼åŠŸèƒ½**ã€‚**ç©ºå€¼**ï¼ˆ*Null* ï¼‰æ˜¯ä¸€ä¸ªå€¼ï¼Œå®ƒä»£è¡¨æ²¡æœ‰å€¼ã€‚åœ¨æœ‰ç©ºå€¼çš„è¯­è¨€ä¸­ï¼Œå˜é‡æ€»æ˜¯è¿™ä¸¤ç§çŠ¶æ€ä¹‹ä¸€ï¼šç©ºå€¼å’Œéç©ºå€¼ã€‚Rust æ²¡æœ‰ç©ºå€¼ï¼Œä¸è¿‡å®ƒç¡®å®æ‹¥æœ‰ä¸€ä¸ªå¯ä»¥ç¼–ç å­˜åœ¨æˆ–ä¸å­˜åœ¨æ¦‚å¿µçš„æšä¸¾ã€‚è¿™ä¸ªæšä¸¾æ˜¯ `Option<T>`ï¼Œè€Œä¸”å®ƒ[å®šä¹‰äºæ ‡å‡†åº“ä¸­](https://doc.rust-lang.org/std/option/enum.Option.html)ï¼Œå¦‚ä¸‹ï¼š

```rust
enum Option<T> {
    None,
    Some(T),
}
```

`Option<T>` æšä¸¾æ˜¯å¦‚æ­¤æœ‰ç”¨ä»¥è‡³äºå®ƒç”šè‡³è¢«åŒ…å«åœ¨äº† prelude ä¹‹ä¸­ï¼Œä½ ä¸éœ€è¦å°†å…¶æ˜¾å¼å¼•å…¥ä½œç”¨åŸŸã€‚å¦å¤–ï¼Œå®ƒçš„æˆå‘˜ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå¯ä»¥ä¸éœ€è¦ `Option::` å‰ç¼€æ¥ç›´æ¥ä½¿ç”¨ `Some` å’Œ `None`ã€‚å³ä¾¿å¦‚æ­¤ `Option<T>` ä¹Ÿä»æ˜¯å¸¸è§„çš„æšä¸¾ï¼Œ`Some(T)` å’Œ `None` ä»æ˜¯ `Option<T>` çš„æˆå‘˜ã€‚

`Option` å€¼çš„ä¾‹å­ï¼š

```rust
    let some_number = Some(5);
    let some_char = Some('e');

    let absent_number: Option<i32> = None;
```

å¯¹äº `absent_number`ï¼ŒRust éœ€è¦æˆ‘ä»¬æŒ‡å®š `Option` æ•´ä½“çš„ç±»å‹ï¼Œå› ä¸ºç¼–è¯‘å™¨åªé€šè¿‡ `None` å€¼æ— æ³•æ¨æ–­å‡º `Some` æˆå‘˜ä¿å­˜çš„å€¼çš„ç±»å‹ã€‚

å¦‚æœè¿è¡Œä¸‹é¢çš„ä»£ç ï¼Œå°†å¾—åˆ°é”™è¯¯ä¿¡æ¯ï¼š

```rust
    let x: i8 = 5;
    let y: Option<i8> = Some(5);

    let sum = x + y;
```

```console
$ cargo run
   Compiling enums v0.1.0 (file:///projects/enums)
error[E0277]: cannot add `Option<i8>` to `i8`
 --> src/main.rs:5:17
  |
5 |     let sum = x + y;
  |                 ^ no implementation for `i8 + Option<i8>`
  |
  = help: the trait `Add<Option<i8>>` is not implemented for `i8`
  = help: the following other types implement trait `Add<Rhs>`:
            <&'a f32 as Add<f32>>
            <&'a f64 as Add<f64>>
            <&'a i128 as Add<i128>>
            <&'a i16 as Add<i16>>
            <&'a i32 as Add<i32>>
            <&'a i64 as Add<i64>>
            <&'a i8 as Add<i8>>
            <&'a isize as Add<isize>>
          and 48 others

For more information about this error, try `rustc --explain E0277`.
error: could not compile `enums` due to previous error
```

é”™è¯¯ä¿¡æ¯æ„å‘³ç€ Rust ä¸çŸ¥é“è¯¥å¦‚ä½•å°† `Option<i8>` ä¸ `i8` ç›¸åŠ ï¼Œå› ä¸ºå®ƒä»¬çš„ç±»å‹ä¸åŒã€‚å½“åœ¨ Rust ä¸­æ‹¥æœ‰ä¸€ä¸ªåƒ `i8` è¿™æ ·ç±»å‹çš„å€¼æ—¶ï¼Œç¼–è¯‘å™¨ç¡®ä¿å®ƒæ€»æ˜¯æœ‰ä¸€ä¸ªæœ‰æ•ˆçš„å€¼ã€‚æˆ‘ä»¬å¯ä»¥è‡ªä¿¡ä½¿ç”¨è€Œæ— éœ€åšç©ºå€¼æ£€æŸ¥ã€‚**åªæœ‰å½“ä½¿ç”¨ `Option<T>`çš„æ—¶å€™éœ€è¦æ‹…å¿ƒå¯èƒ½æ²¡æœ‰å€¼**ï¼Œè€Œç¼–è¯‘å™¨ä¼šç¡®ä¿æˆ‘ä»¬åœ¨ä½¿ç”¨å€¼ä¹‹å‰å¤„ç†äº†ä¸ºç©ºçš„æƒ…å†µã€‚æ¢å¥è¯è¯´ï¼Œ**åœ¨å¯¹ `Option<T>` è¿›è¡Œè¿ç®—ä¹‹å‰å¿…é¡»å°†å…¶è½¬æ¢ä¸º `T`**ã€‚é€šå¸¸è¿™èƒ½å¸®åŠ©æˆ‘ä»¬æ•è·åˆ°ç©ºå€¼æœ€å¸¸è§çš„é—®é¢˜ä¹‹ä¸€ï¼šå‡è®¾æŸå€¼ä¸ä¸ºç©ºä½†å®é™…ä¸Šä¸ºç©ºçš„æƒ…å†µã€‚

æ€»çš„æ¥è¯´ï¼Œä¸ºäº†ä½¿ç”¨ `Option<T>` å€¼ï¼Œéœ€è¦ç¼–å†™å¤„ç†æ¯ä¸ªæˆå‘˜çš„ä»£ç ã€‚ä½ æƒ³è¦ä¸€äº›ä»£ç åªå½“æ‹¥æœ‰ `Some(T)` å€¼æ—¶è¿è¡Œï¼Œå…è®¸è¿™äº›ä»£ç ä½¿ç”¨å…¶ä¸­çš„ `T`ã€‚ä¹Ÿå¸Œæœ›ä¸€äº›ä»£ç åªåœ¨å€¼ä¸º `None` æ—¶è¿è¡Œï¼Œè¿™äº›ä»£ç å¹¶æ²¡æœ‰ä¸€ä¸ªå¯ç”¨çš„ `T` å€¼ã€‚`match` è¡¨è¾¾å¼å°±æ˜¯è¿™ä¹ˆä¸€ä¸ªå¤„ç†æšä¸¾çš„æ§åˆ¶æµç»“æ„ï¼šå®ƒä¼šæ ¹æ®æšä¸¾çš„æˆå‘˜è¿è¡Œä¸åŒçš„ä»£ç ï¼Œè¿™äº›ä»£ç å¯ä»¥ä½¿ç”¨åŒ¹é…åˆ°çš„å€¼ä¸­çš„æ•°æ®ã€‚

#### matchæ§åˆ¶æµğŸ§

Rust æœ‰ä¸€ä¸ªå«åš `match` çš„æä¸ºå¼ºå¤§çš„æ§åˆ¶æµè¿ç®—ç¬¦ï¼Œå®ƒå…è®¸æˆ‘ä»¬å°†ä¸€ä¸ªå€¼ä¸ä¸€ç³»åˆ—çš„æ¨¡å¼ç›¸æ¯”è¾ƒï¼Œå¹¶æ ¹æ®ç›¸åŒ¹é…çš„æ¨¡å¼æ‰§è¡Œç›¸åº”ä»£ç ã€‚æ¨¡å¼å¯ç”±å­—é¢å€¼ã€å˜é‡ã€é€šé…ç¬¦å’Œè®¸å¤šå…¶ä»–å†…å®¹æ„æˆã€‚

æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥è·å–ä¸€ä¸ªæœªçŸ¥çš„ç¡¬å¸ï¼Œå¹¶ä»¥ä¸€ç§ç±»ä¼¼éªŒé’æœºçš„æ–¹å¼ï¼Œç¡®å®šå®ƒæ˜¯ä½•ç§ç¡¬å¸å¹¶è¿”å›å®ƒçš„ç¾åˆ†å€¼ï¼š

```rust
enum Coin {
    Penny,
    Nickel,
    Dime,
    Quarter,
}

fn value_in_cents(coin: Coin) -> u8 {
    match coin {
        Coin::Penny => 1,
        Coin::Nickel => 5,
        Coin::Dime => 10,
        Coin::Quarter => 25,
    }
}
```

æˆ‘ä»¬åˆ—å‡º `match` å…³é”®å­—åè·Ÿä¸€ä¸ªè¡¨è¾¾å¼ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯ `coin` çš„å€¼ã€‚è¿™çœ‹èµ·æ¥éå¸¸åƒ `if` æ‰€ä½¿ç”¨çš„æ¡ä»¶è¡¨è¾¾å¼ï¼Œä¸è¿‡è¿™é‡Œæœ‰ä¸€ä¸ªéå¸¸å¤§çš„åŒºåˆ«ï¼š**å¯¹äº `if`ï¼Œè¡¨è¾¾å¼å¿…é¡»è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè€Œè¿™é‡Œå®ƒå¯ä»¥æ˜¯ä»»ä½•ç±»å‹çš„**ã€‚

å½“ `match` è¡¨è¾¾å¼æ‰§è¡Œæ—¶ï¼Œå®ƒå°†ç»“æœå€¼æŒ‰é¡ºåºä¸æ¯ä¸€ä¸ªåˆ†æ”¯çš„æ¨¡å¼ç›¸æ¯”è¾ƒã€‚å¦‚æœæ¨¡å¼åŒ¹é…äº†è¿™ä¸ªå€¼ï¼Œè¿™ä¸ªæ¨¡å¼ç›¸å…³è”çš„ä»£ç å°†è¢«æ‰§è¡Œã€‚å¦‚æœæ¨¡å¼å¹¶ä¸åŒ¹é…è¿™ä¸ªå€¼ï¼Œå°†ç»§ç»­æ‰§è¡Œä¸‹ä¸€ä¸ªåˆ†æ”¯ã€‚

å¦‚æœåˆ†æ”¯ä»£ç è¾ƒçŸ­çš„è¯é€šå¸¸ä¸ä½¿ç”¨å¤§æ‹¬å·ï¼Œæ­£å¦‚ç¤ºä¾‹ 6-3 ä¸­çš„æ¯ä¸ªåˆ†æ”¯éƒ½åªæ˜¯è¿”å›ä¸€ä¸ªå€¼ã€‚å¦‚æœæƒ³è¦åœ¨åˆ†æ”¯ä¸­è¿è¡Œå¤šè¡Œä»£ç ï¼Œå¯ä»¥ä½¿ç”¨å¤§æ‹¬å·ï¼Œè€Œåˆ†æ”¯åçš„é€—å·æ˜¯å¯é€‰çš„ã€‚ä¾‹å¦‚ï¼Œå¦‚ä¸‹ä»£ç åœ¨æ¯æ¬¡ä½¿ç”¨`Coin::Penny` è°ƒç”¨æ—¶éƒ½ä¼šæ‰“å°å‡º â€œLucky penny!â€ï¼ŒåŒæ—¶ä»ç„¶è¿”å›ä»£ç å—æœ€åçš„å€¼ï¼Œ`1`ï¼š

```rust
fn value_in_cents(coin: Coin) -> u8 {
    match coin {
        Coin::Penny => {
            println!("Lucky penny!");
            1
        }
        Coin::Nickel => 5,
        Coin::Dime => 10,
        Coin::Quarter => 25,
    }
}
```

- **ç»‘å®šå€¼çš„æ¨¡å¼**

  åŒ¹é…åˆ†æ”¯çš„å¦ä¸€ä¸ªæœ‰ç”¨çš„åŠŸèƒ½æ˜¯å¯ä»¥ç»‘å®šåŒ¹é…çš„æ¨¡å¼çš„éƒ¨åˆ†å€¼ã€‚è¿™ä¹Ÿå°±æ˜¯å¦‚ä½•ä»æšä¸¾æˆå‘˜ä¸­æå–å€¼çš„ã€‚

  ä½œä¸ºä¸€ä¸ªä¾‹å­ï¼Œè®©æˆ‘ä»¬ä¿®æ”¹æšä¸¾çš„ä¸€ä¸ªæˆå‘˜æ¥å­˜æ”¾æ•°æ®ã€‚1999 å¹´åˆ° 2008 å¹´é—´ï¼Œç¾å›½åœ¨ 25 ç¾åˆ†çš„ç¡¬å¸çš„ä¸€ä¾§ä¸º 50 ä¸ªå·çš„æ¯ä¸€ä¸ªéƒ½å°åˆ·äº†ä¸åŒçš„è®¾è®¡ã€‚å…¶ä»–çš„ç¡¬å¸éƒ½æ²¡æœ‰è¿™ç§åŒºåˆ†å·çš„è®¾è®¡ï¼Œæ‰€ä»¥åªæœ‰è¿™äº› 25 ç¾åˆ†ç¡¬å¸æœ‰ç‰¹æ®Šçš„ä»·å€¼ã€‚å¯ä»¥å°†è¿™äº›ä¿¡æ¯åŠ å…¥æˆ‘ä»¬çš„ `enum`ï¼Œé€šè¿‡æ”¹å˜ `Quarter` æˆå‘˜æ¥åŒ…å«ä¸€ä¸ª `State` å€¼ï¼Œç¤ºä¾‹ 6-4 ä¸­å®Œæˆäº†è¿™äº›ä¿®æ”¹ï¼š

  ```rust
  #[derive(Debug)] // è¿™æ ·å¯ä»¥ç«‹åˆ»çœ‹åˆ°å·çš„åç§°
  enum UsState {
      Alabama,
      Alaska,
      // --snip--
  }
  
  enum Coin {
      Penny,
      Nickel,
      Dime,
      Quarter(UsState),
  }
  ```

  ç¤ºä¾‹ 6-4ï¼š`Quarter` æˆå‘˜ä¹Ÿå­˜æ”¾äº†ä¸€ä¸ª `UsState` å€¼çš„ `Coin` æšä¸¾

  æƒ³è±¡ä¸€ä¸‹æˆ‘ä»¬çš„ä¸€ä¸ªæœ‹å‹å°è¯•æ”¶é›†æ‰€æœ‰ 50 ä¸ªå·çš„ 25 ç¾åˆ†ç¡¬å¸ã€‚åœ¨æ ¹æ®ç¡¬å¸ç±»å‹åˆ†ç±»é›¶é’±çš„åŒæ—¶ï¼Œä¹Ÿå¯ä»¥æŠ¥å‘Šå‡ºæ¯ä¸ª 25 ç¾åˆ†ç¡¬å¸æ‰€å¯¹åº”çš„å·åç§°ï¼Œè¿™æ ·å¦‚æœæˆ‘ä»¬çš„æœ‹å‹æ²¡æœ‰çš„è¯ï¼Œä»–å¯ä»¥å°†å…¶åŠ å…¥æ”¶è—ã€‚

  åœ¨è¿™äº›ä»£ç çš„åŒ¹é…è¡¨è¾¾å¼ä¸­ï¼Œæˆ‘ä»¬åœ¨åŒ¹é… `Coin::Quarter` æˆå‘˜çš„åˆ†æ”¯çš„æ¨¡å¼ä¸­å¢åŠ äº†ä¸€ä¸ªå«åš `state` çš„å˜é‡ã€‚å½“åŒ¹é…åˆ° `Coin::Quarter` æ—¶ï¼Œå˜é‡ `state` å°†ä¼šç»‘å®š 25 ç¾åˆ†ç¡¬å¸æ‰€å¯¹åº”å·çš„å€¼ã€‚æ¥ç€åœ¨é‚£ä¸ªåˆ†æ”¯çš„ä»£ç ä¸­ä½¿ç”¨ `state`ï¼Œå¦‚ä¸‹ï¼š

  ```rust
  fn value_in_cents(coin: Coin) -> u8 {
      match coin {
          Coin::Penny => 1,
          Coin::Nickel => 5,
          Coin::Dime => 10,
          Coin::Quarter(state) => {
              println!("State quarter from {:?}!", state);
              25
          }
      }
  }
  ```

  å¦‚æœè°ƒç”¨ `value_in_cents(Coin::Quarter(UsState::Alaska))`ï¼Œ`coin` å°†æ˜¯ `Coin::Quarter(UsState::Alaska)`ã€‚å½“å°†å€¼ä¸æ¯ä¸ªåˆ†æ”¯ç›¸æ¯”è¾ƒæ—¶ï¼Œæ²¡æœ‰åˆ†æ”¯ä¼šåŒ¹é…ï¼Œç›´åˆ°é‡åˆ° `Coin::Quarter(state)`ã€‚è¿™æ—¶ï¼Œ`state` ç»‘å®šçš„å°†ä¼šæ˜¯å€¼ `UsState::Alaska`ã€‚æ¥ç€å°±å¯ä»¥åœ¨ `println!` è¡¨è¾¾å¼ä¸­ä½¿ç”¨è¿™ä¸ªç»‘å®šäº†ï¼Œåƒè¿™æ ·å°±å¯ä»¥è·å– `Coin` æšä¸¾çš„ `Quarter` æˆå‘˜ä¸­å†…éƒ¨çš„å·çš„å€¼ã€‚

- **åŒ¹é… `Option<T>`**

```rust
    fn plus_one(x: Option<i32>) -> Option<i32> {
        match x {
            None => None,
            Some(i) => Some(i + 1),
        }
    }

    let five = Some(5);         
    let six = plus_one(five);	// Some(6)
    let none = plus_one(None);  // None
```

- **åŒ¹é…æ˜¯ç©·å°½çš„**

  `match` è¿˜æœ‰å¦ä¸€æ–¹é¢éœ€è¦è®¨è®ºï¼šè¿™äº›åˆ†æ”¯å¿…é¡»è¦†ç›–äº†æ‰€æœ‰çš„å¯èƒ½æ€§ã€‚è€ƒè™‘ä¸€ä¸‹ `plus_one` å‡½æ•°çš„è¿™ä¸ªç‰ˆæœ¬ï¼Œå®ƒæœ‰ä¸€ä¸ª bug å¹¶ä¸èƒ½ç¼–è¯‘ï¼š

```rust
    fn plus_one(x: Option<i32>) -> Option<i32> {
        match x {
            Some(i) => Some(i + 1),
        }
    }
```

æˆ‘ä»¬æ²¡æœ‰å¤„ç† `None` çš„æƒ…å†µï¼Œæ‰€ä»¥è¿™äº›ä»£ç ä¼šé€ æˆä¸€ä¸ª bugã€‚

- **é€šé…æ¨¡å¼å’Œ `_` å ä½ç¬¦**

  è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¸Œæœ›å¯¹ä¸€äº›ç‰¹å®šçš„å€¼é‡‡å–ç‰¹æ®Šæ“ä½œï¼Œè€Œå¯¹å…¶ä»–çš„å€¼é‡‡å–é»˜è®¤æ“ä½œã€‚æƒ³è±¡æˆ‘ä»¬æ­£åœ¨ç©ä¸€ä¸ªæ¸¸æˆï¼Œå¦‚æœä½ æ·å‡ºéª°å­çš„å€¼ä¸º 3ï¼Œè§’è‰²ä¸ä¼šç§»åŠ¨ï¼Œè€Œæ˜¯ä¼šå¾—åˆ°ä¸€é¡¶æ–°å¥‡çš„å¸½å­ã€‚å¦‚æœä½ æ·å‡ºäº† 7ï¼Œä½ çš„è§’è‰²å°†å¤±å»æ–°å¥‡çš„å¸½å­ã€‚å¯¹äºå…¶ä»–çš„æ•°å€¼ï¼Œä½ çš„è§’è‰²ä¼šåœ¨æ£‹ç›˜ä¸Šç§»åŠ¨ç›¸åº”çš„æ ¼å­ã€‚è¿™æ˜¯ä¸€ä¸ªå®ç°äº†ä¸Šè¿°é€»è¾‘çš„ `match`ï¼Œéª°å­çš„ç»“æœæ˜¯ç¡¬ç¼–ç è€Œä¸æ˜¯ä¸€ä¸ªéšæœºå€¼ï¼Œå…¶ä»–çš„é€»è¾‘éƒ¨åˆ†ä½¿ç”¨äº†æ²¡æœ‰å‡½æ•°ä½“çš„å‡½æ•°æ¥è¡¨ç¤ºï¼Œå®ç°å®ƒä»¬è¶…å‡ºäº†æœ¬ä¾‹çš„èŒƒå›´ï¼š

  ```rust
      let dice_roll = 9;
      match dice_roll {
          3 => add_fancy_hat(),
          7 => remove_fancy_hat(),
          other => move_player(other),
      }
  
      fn add_fancy_hat() {}
      fn remove_fancy_hat() {}
      fn move_player(num_spaces: u8) {}
  ```

  å¯¹äºå‰ä¸¤ä¸ªåˆ†æ”¯ï¼ŒåŒ¹é…æ¨¡å¼æ˜¯å­—é¢å€¼ `3` å’Œ `7`ï¼Œæœ€åä¸€ä¸ªåˆ†æ”¯åˆ™æ¶µç›–äº†æ‰€æœ‰å…¶ä»–å¯èƒ½çš„å€¼ï¼Œæ¨¡å¼æ˜¯æˆ‘ä»¬å‘½åä¸º `other` çš„ä¸€ä¸ªå˜é‡ã€‚`other` åˆ†æ”¯çš„ä»£ç é€šè¿‡å°†å…¶ä¼ é€’ç»™ `move_player` å‡½æ•°æ¥ä½¿ç”¨è¿™ä¸ªå˜é‡ã€‚

  å³ä½¿æˆ‘ä»¬æ²¡æœ‰åˆ—å‡º `u8` æ‰€æœ‰å¯èƒ½çš„å€¼ï¼Œè¿™æ®µä»£ç ä¾ç„¶èƒ½å¤Ÿç¼–è¯‘ï¼Œå› ä¸ºæœ€åä¸€ä¸ªæ¨¡å¼å°†åŒ¹é…æ‰€æœ‰æœªè¢«ç‰¹æ®Šåˆ—å‡ºçš„å€¼ã€‚è¿™ç§é€šé…æ¨¡å¼æ»¡è¶³äº† `match` å¿…é¡»è¢«ç©·å°½çš„è¦æ±‚ã€‚è¯·æ³¨æ„ï¼Œ**æˆ‘ä»¬å¿…é¡»å°†é€šé…åˆ†æ”¯æ”¾åœ¨æœ€åï¼Œå› ä¸ºæ¨¡å¼æ˜¯æŒ‰é¡ºåºåŒ¹é…çš„**ã€‚

  Rust è¿˜æä¾›äº†ä¸€ä¸ªæ¨¡å¼ï¼Œå½“æˆ‘ä»¬ä¸æƒ³ä½¿ç”¨é€šé…æ¨¡å¼è·å–çš„å€¼æ—¶ï¼Œè¯·ä½¿ç”¨ `_` ï¼Œè¿™æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ¨¡å¼ï¼Œå¯ä»¥åŒ¹é…ä»»æ„å€¼è€Œä¸ç»‘å®šåˆ°è¯¥å€¼ã€‚è¿™å‘Šè¯‰ Rust æˆ‘ä»¬ä¸ä¼šä½¿ç”¨è¿™ä¸ªå€¼ï¼Œæ‰€ä»¥ Rust ä¹Ÿä¸ä¼šè­¦å‘Šæˆ‘ä»¬å­˜åœ¨æœªä½¿ç”¨çš„å˜é‡ã€‚

  è®©æˆ‘ä»¬æ”¹å˜æ¸¸æˆè§„åˆ™ï¼šç°åœ¨ï¼Œå½“ä½ æ·å‡ºçš„å€¼ä¸æ˜¯ 3 æˆ– 7 çš„æ—¶å€™ï¼Œä½ å¿…é¡»å†æ¬¡æ·å‡ºã€‚è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬ä¸éœ€è¦ä½¿ç”¨è¿™ä¸ªå€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬æ”¹åŠ¨ä»£ç ä½¿ç”¨ `_` æ¥æ›¿ä»£å˜é‡ `other` ï¼š

  ```rust
      let dice_roll = 9;
      match dice_roll {
          3 => add_fancy_hat(),
          7 => remove_fancy_hat(),
          _ => reroll(),
      }
  
      fn add_fancy_hat() {}
      fn remove_fancy_hat() {}
      fn reroll() {}
  ```

- **`if let` ç®€æ´æ§åˆ¶æµ** 

  è€ƒè™‘ä¸‹é¢çš„ç¨‹åºï¼Œå®ƒåŒ¹é…ä¸€ä¸ª `config_max` å˜é‡ä¸­çš„ `Option<u8>` å€¼å¹¶åªå¸Œæœ›å½“å€¼ä¸º `Some` æˆå‘˜æ—¶æ‰§è¡Œä»£ç ï¼š

  ```rust
      let config_max = Some(3u8);
      match config_max {
          Some(max) => println!("The maximum is configured to be {}", max),
          _ => (),
      }
  ```

  æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `if let` è¿™ç§æ›´çŸ­çš„æ–¹å¼ç¼–å†™ã€‚`if let` æ˜¯ `match` çš„ä¸€ä¸ªè¯­æ³•ç³–ï¼Œå®ƒå½“å€¼åŒ¹é…æŸä¸€æ¨¡å¼æ—¶æ‰§è¡Œä»£ç è€Œå¿½ç•¥æ‰€æœ‰å…¶ä»–å€¼ã€‚å¦‚ä¸‹ä»£ç ä¸Šé¢çš„ `match` è¡Œä¸ºä¸€è‡´ï¼š

  ```rust
  	let config_max = Some(3u8);
  	if let Some(max) = config_max {
     		println!("The maximum is configured to be {}", max);
  	}
  ```

  å¯ä»¥åœ¨ `if let` ä¸­åŒ…å«ä¸€ä¸ª `else`ã€‚`else` å—ä¸­çš„ä»£ç ä¸ `match` è¡¨è¾¾å¼ä¸­çš„ `_` åˆ†æ”¯å—ä¸­çš„ä»£ç ç›¸åŒï¼Œè¿™æ ·çš„ `match` è¡¨è¾¾å¼å°±ç­‰åŒäº `if let` å’Œ `else`ï¼š

  ```rust
      let mut count = 0;
      match coin {
          Coin::Quarter(state) => println!("State quarter from {:?}!", state),
          _ => count += 1,
      }
  ```
  
  ç­‰ä»·äºï¼š
  
  ```rust
  	let mut count = 0;
  	if let Coin::Quarter(state) = coin {
      	println!("State quarter from {:?}!", state);
  	} else {
      	count += 1;
  	}
  ```

- **å¼•ç”¨è§£æ„ğŸ¤”**

  1. ğŸŒŸğŸŒŸ ä½¿ç”¨æ¨¡å¼ `&mut V` å»åŒ¹é…ä¸€ä¸ªå¯å˜å¼•ç”¨æ—¶ï¼Œä½ éœ€è¦æ ¼å¤–å°å¿ƒï¼Œå› ä¸ºåŒ¹é…å‡ºæ¥çš„ `V` æ˜¯ä¸€ä¸ªå€¼ï¼Œè€Œä¸æ˜¯å¯å˜å¼•ç”¨

  ```rust
  fn main() {
      let mut v = String::from("hello,");
      let r = &mut v;
  
      match r {
       &mut value => value.push_str(" world!") // æ­¤å¤„valueè¢«è§£æ„ä¸ºä¸å¯å˜Stringç±»å‹ï¼ŒæŠ¥é”™
      }
  }
  ```

### æ¨¡å—ç³»ç»Ÿ

Rust æœ‰è®¸å¤šåŠŸèƒ½å¯ä»¥è®©ä½ ç®¡ç†ä»£ç çš„ç»„ç»‡ï¼ŒåŒ…æ‹¬å“ªäº›å†…å®¹å¯ä»¥è¢«å…¬å¼€ï¼Œå“ªäº›å†…å®¹ä½œä¸ºç§æœ‰éƒ¨åˆ†ï¼Œä»¥åŠç¨‹åºæ¯ä¸ªä½œç”¨åŸŸä¸­çš„åå­—ã€‚è¿™äº›åŠŸèƒ½ã€‚è¿™æœ‰æ—¶è¢«ç§°ä¸º â€œæ¨¡å—ç³»ç»Ÿï¼ˆthe module systemï¼‰â€ï¼ŒåŒ…æ‹¬ï¼š

- **åŒ…**ï¼ˆ*Packages*ï¼‰ï¼šCargo çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒå…è®¸ä½ æ„å»ºã€æµ‹è¯•å’Œåˆ†äº« crateã€‚
- **Crates** ï¼šä¸€ä¸ªæ¨¡å—çš„æ ‘å½¢ç»“æ„ï¼Œå®ƒå½¢æˆäº†åº“æˆ–äºŒè¿›åˆ¶é¡¹ç›®ã€‚
- **æ¨¡å—**ï¼ˆ*Modules*ï¼‰å’Œ **use**ï¼šå…è®¸ä½ æ§åˆ¶ä½œç”¨åŸŸå’Œè·¯å¾„çš„ç§æœ‰æ€§ã€‚
- **è·¯å¾„**ï¼ˆ*path*ï¼‰ï¼šä¸€ä¸ªå‘½åä¾‹å¦‚ç»“æ„ä½“ã€å‡½æ•°æˆ–æ¨¡å—ç­‰é¡¹çš„æ–¹å¼

æœ¬ç« å°†ä¼šæ¶µç›–æ‰€æœ‰è¿™äº›æ¦‚å¿µï¼Œè®¨è®ºå®ƒä»¬å¦‚ä½•äº¤äº’ï¼Œå¹¶è¯´æ˜å¦‚ä½•ä½¿ç”¨å®ƒä»¬æ¥ç®¡ç†ä½œç”¨åŸŸã€‚åˆ°æœ€åï¼Œä½ ä¼šå¯¹æ¨¡å—ç³»ç»Ÿæœ‰æ·±å…¥çš„äº†è§£ï¼Œå¹¶ä¸”èƒ½å¤Ÿåƒä¸“ä¸šäººå£«ä¸€æ ·ä½¿ç”¨ä½œç”¨åŸŸï¼

#### åŒ…å’ŒCrate

**crate æ˜¯ Rust åœ¨ç¼–è¯‘æ—¶æœ€å°çš„ä»£ç å•ä½ã€‚**å¦‚æœä½ ç”¨ `rustc` è€Œä¸æ˜¯ `cargo` æ¥ç¼–è¯‘ä¸€ä¸ªæ–‡ä»¶ï¼Œç¼–è¯‘å™¨è¿˜æ˜¯ä¼šå°†é‚£ä¸ªæ–‡ä»¶è®¤ä½œä¸€ä¸ª crateã€‚crate å¯ä»¥åŒ…å«æ¨¡å—ï¼Œæ¨¡å—å¯ä»¥å®šä¹‰åœ¨å…¶ä»–æ–‡ä»¶ï¼Œç„¶åå’Œ crate ä¸€èµ·ç¼–è¯‘ã€‚

crate æœ‰ä¸¤ç§å½¢å¼ï¼š**äºŒè¿›åˆ¶é¡¹**å’Œ**åº“**ã€‚

**äºŒè¿›åˆ¶é¡¹** å¯ä»¥è¢«ç¼–è¯‘ä¸ºå¯æ‰§è¡Œç¨‹åºï¼Œæ¯”å¦‚ä¸€ä¸ªå‘½ä»¤è¡Œç¨‹åºæˆ–è€…ä¸€ä¸ªæœåŠ¡å™¨ã€‚å®ƒä»¬å¿…é¡»æœ‰ä¸€ä¸ª `main` å‡½æ•°æ¥å®šä¹‰å½“ç¨‹åºè¢«æ‰§è¡Œçš„æ—¶å€™æ‰€éœ€è¦åšçš„äº‹æƒ…ã€‚ç›®å‰æˆ‘ä»¬æ‰€åˆ›å»ºçš„ crate éƒ½æ˜¯äºŒè¿›åˆ¶é¡¹ã€‚

**åº“** å¹¶æ²¡æœ‰ `main` å‡½æ•°ï¼Œå®ƒä»¬ä¹Ÿä¸ä¼šç¼–è¯‘ä¸ºå¯æ‰§è¡Œç¨‹åºï¼Œå®ƒä»¬æä¾›ä¸€äº›è¯¸å¦‚å‡½æ•°ä¹‹ç±»çš„ä¸œè¥¿ï¼Œä½¿å…¶ä»–é¡¹ç›®ä¹Ÿèƒ½ä½¿ç”¨è¿™äº›ä¸œè¥¿ã€‚æ¯”å¦‚ [ç¬¬äºŒç« ](https://kaisery.github.io/trpl-zh-cn/ch02-00-guessing-game-tutorial.html#ç”Ÿæˆä¸€ä¸ªéšæœºæ•°) çš„ `rand` crate å°±æä¾›äº†ç”Ÿæˆéšæœºæ•°çš„ä¸œè¥¿ã€‚å¤§å¤šæ•°æ—¶é—´ `Rustaceans` è¯´çš„ crate æŒ‡çš„éƒ½æ˜¯åº“ï¼Œè¿™ä¸å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­ library æ¦‚å¿µä¸€è‡´ã€‚

**åŒ…**ï¼ˆ*package*ï¼‰æ˜¯æä¾›ä¸€ç³»åˆ—åŠŸèƒ½çš„ä¸€ä¸ªæˆ–è€…å¤šä¸ª crateã€‚**ä¸€ä¸ªåŒ…ä¼šåŒ…å«ä¸€ä¸ª *Cargo.toml* æ–‡ä»¶ï¼Œé˜è¿°å¦‚ä½•å»æ„å»ºè¿™äº› crate**ã€‚Cargo å°±æ˜¯ä¸€ä¸ªåŒ…å«æ„å»ºä½ ä»£ç çš„äºŒè¿›åˆ¶é¡¹çš„åŒ…ã€‚Cargo ä¹ŸåŒ…å«è¿™äº›äºŒè¿›åˆ¶é¡¹æ‰€ä¾èµ–çš„åº“ã€‚å…¶ä»–é¡¹ç›®ä¹Ÿèƒ½ç”¨ Cargo åº“æ¥å®ç°ä¸ Cargo å‘½ä»¤è¡Œç¨‹åºä¸€æ ·çš„é€»è¾‘ã€‚

#### æ¨¡å—

åœ¨æœ¬èŠ‚ï¼Œæˆ‘ä»¬å°†è®¨è®ºæ¨¡å—å’Œå…¶å®ƒä¸€äº›å…³äºæ¨¡å—ç³»ç»Ÿçš„éƒ¨åˆ†ï¼Œå¦‚å…è®¸ä½ å‘½åé¡¹çš„ *è·¯å¾„*ï¼ˆ*paths*ï¼‰ï¼›ç”¨æ¥å°†è·¯å¾„å¼•å…¥ä½œç”¨åŸŸçš„ `use` å…³é”®å­—ï¼›ä»¥åŠä½¿é¡¹å˜ä¸ºå…¬æœ‰çš„ `pub` å…³é”®å­—ã€‚æˆ‘ä»¬è¿˜å°†è®¨è®º `as` å…³é”®å­—ã€å¤–éƒ¨åŒ…å’Œ glob è¿ç®—ç¬¦ã€‚

è¿™é‡Œæˆ‘ä»¬æä¾›ä¸€ä¸ªç®€å•çš„å‚è€ƒï¼Œç”¨æ¥è§£é‡Šæ¨¡å—ã€è·¯å¾„ã€`use`å…³é”®è¯å’Œ`pub`å…³é”®è¯å¦‚ä½•åœ¨ç¼–è¯‘å™¨ä¸­å·¥ä½œï¼Œä»¥åŠå¤§éƒ¨åˆ†å¼€å‘è€…å¦‚ä½•ç»„ç»‡ä»–ä»¬çš„ä»£ç ã€‚æˆ‘ä»¬å°†åœ¨æœ¬ç« èŠ‚ä¸­ä¸¾ä¾‹è¯´æ˜æ¯æ¡è§„åˆ™ï¼Œä¸è¿‡è¿™æ˜¯ä¸€ä¸ªè§£é‡Šæ¨¡å—å·¥ä½œæ–¹å¼çš„è‰¯å¥½å‚è€ƒã€‚

  - **ä» crate æ ¹èŠ‚ç‚¹å¼€å§‹**: å½“ç¼–è¯‘ä¸€ä¸ª crate, ç¼–è¯‘å™¨é¦–å…ˆåœ¨ crate æ ¹æ–‡ä»¶ï¼ˆé€šå¸¸ï¼Œå¯¹äºä¸€ä¸ªåº“ crate è€Œè¨€æ˜¯*src/lib.rs*ï¼Œå¯¹äºä¸€ä¸ªäºŒè¿›åˆ¶ crate è€Œè¨€æ˜¯*src/main.rs*ï¼‰ä¸­å¯»æ‰¾éœ€è¦è¢«ç¼–è¯‘çš„ä»£ç ã€‚

  - **å£°æ˜æ¨¡å—**: åœ¨ crate æ ¹æ–‡ä»¶ä¸­ï¼Œä½ å¯ä»¥å£°æ˜ä¸€ä¸ªæ–°æ¨¡å—ï¼›æ¯”å¦‚ï¼Œä½ ç”¨`mod garden`å£°æ˜äº†ä¸€ä¸ªå«åš`garden`çš„æ¨¡å—ã€‚ç¼–è¯‘å™¨ä¼šåœ¨ä¸‹åˆ—è·¯å¾„ä¸­å¯»æ‰¾æ¨¡å—ä»£ç ï¼š
    - å†…è”ï¼Œåœ¨å¤§æ‹¬å·ä¸­ï¼Œå½“`mod garden`åæ–¹ä¸æ˜¯ä¸€ä¸ªåˆ†å·è€Œæ˜¯ä¸€ä¸ªå¤§æ‹¬å·
    - åœ¨æ–‡ä»¶ *src/garden.rs*
    - åœ¨æ–‡ä»¶ *src/garden/mod.rs*
    
  - **å£°æ˜å­æ¨¡å—**: åœ¨é™¤äº† crate æ ¹èŠ‚ç‚¹ä»¥å¤–çš„å…¶ä»–æ–‡ä»¶ä¸­ï¼Œä½ å¯ä»¥å®šä¹‰å­æ¨¡å—ã€‚æ¯”å¦‚ï¼Œä½ å¯èƒ½åœ¨src/garden.rsä¸­å®šä¹‰äº†`mod vegetables;`ã€‚ç¼–è¯‘å™¨ä¼šåœ¨ä»¥çˆ¶æ¨¡å—å‘½åçš„ç›®å½•ä¸­å¯»æ‰¾å­æ¨¡å—ä»£ç ï¼š
    - å†…è”ï¼Œåœ¨å¤§æ‹¬å·ä¸­ï¼Œå½“`mod vegetables`åæ–¹ä¸æ˜¯ä¸€ä¸ªåˆ†å·è€Œæ˜¯ä¸€ä¸ªå¤§æ‹¬å·
    - åœ¨æ–‡ä»¶ *src/garden/vegetables.rs*
    - åœ¨æ–‡ä»¶ *src/garden/vegetables/mod.rs*
    
  - **æ¨¡å—ä¸­çš„ä»£ç è·¯å¾„**: ä¸€æ—¦ä¸€ä¸ªæ¨¡å—æ˜¯ä½  crate çš„ä¸€éƒ¨åˆ†ï¼Œä½ å¯ä»¥åœ¨éšç§è§„åˆ™å…è®¸çš„å‰æä¸‹ï¼Œä»åŒä¸€ä¸ª crate å†…çš„ä»»æ„åœ°æ–¹ï¼Œé€šè¿‡ä»£ç è·¯å¾„å¼•ç”¨è¯¥æ¨¡å—çš„ä»£ç ã€‚ä¸¾ä¾‹è€Œè¨€ï¼Œä¸€ä¸ª garden vegetables æ¨¡å—ä¸‹çš„`Asparagus`ç±»å‹å¯ä»¥åœ¨`crate::garden::vegetables::Asparagus`è¢«æ‰¾åˆ°ã€‚

  - **ç§æœ‰ vs å…¬ç”¨**: ä¸€ä¸ªæ¨¡å—é‡Œçš„ä»£ç é»˜è®¤å¯¹å…¶çˆ¶æ¨¡å—ç§æœ‰ã€‚ä¸ºäº†ä½¿ä¸€ä¸ªæ¨¡å—å…¬ç”¨ï¼Œåº”å½“åœ¨å£°æ˜æ—¶ä½¿ç”¨`pub mod`æ›¿ä»£`mod`ã€‚ä¸ºäº†ä½¿ä¸€ä¸ªå…¬ç”¨æ¨¡å—å†…éƒ¨çš„æˆå‘˜å…¬ç”¨ï¼Œåº”å½“åœ¨å£°æ˜å‰ä½¿ç”¨`pub`ã€‚

  - **`use` å…³é”®å­—**: åœ¨ä¸€ä¸ªä½œç”¨åŸŸå†…ï¼Œ`use`å…³é”®å­—åˆ›å»ºäº†ä¸€ä¸ªæˆå‘˜çš„å¿«æ·æ–¹å¼ï¼Œç”¨æ¥å‡å°‘é•¿è·¯å¾„çš„é‡å¤ã€‚åœ¨ä»»ä½•å¯ä»¥å¼•ç”¨`crate::garden::vegetables::Asparagus`çš„ä½œç”¨åŸŸï¼Œä½ å¯ä»¥é€šè¿‡ `use crate::garden::vegetables::Asparagus;`åˆ›å»ºä¸€ä¸ªå¿«æ·æ–¹å¼ï¼Œç„¶åä½ å°±å¯ä»¥åœ¨ä½œç”¨åŸŸä¸­åªå†™`Asparagus`æ¥ä½¿ç”¨è¯¥ç±»å‹ã€‚

#### åœ¨æ¨¡å—ä¸­å¯¹ç›¸å…³ä»£ç è¿›è¡Œåˆ†ç»„

*æ¨¡å—* è®©æˆ‘ä»¬å¯ä»¥å°†ä¸€ä¸ª crate ä¸­çš„ä»£ç è¿›è¡Œåˆ†ç»„ï¼Œä»¥æé«˜å¯è¯»æ€§ä¸é‡ç”¨æ€§ã€‚å› ä¸ºä¸€ä¸ªæ¨¡å—ä¸­çš„ä»£ç é»˜è®¤æ˜¯ç§æœ‰çš„ï¼Œæ‰€ä»¥è¿˜å¯ä»¥åˆ©ç”¨æ¨¡å—æ§åˆ¶é¡¹çš„ *ç§æœ‰æ€§*ã€‚ç§æœ‰é¡¹æ˜¯ä¸å¯ä¸ºå¤–éƒ¨ä½¿ç”¨çš„å†…åœ¨è¯¦ç»†å®ç°ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†æ¨¡å—å’Œå®ƒå…¶ä¸­çš„é¡¹æ ‡è®°ä¸ºå…¬å¼€çš„ï¼Œè¿™æ ·ï¼Œå¤–éƒ¨ä»£ç å°±å¯ä»¥ä½¿ç”¨å¹¶ä¾èµ–ä¸å®ƒä»¬ã€‚

åœ¨é¤é¥®ä¸šï¼Œé¤é¦†ä¸­ä¼šæœ‰ä¸€äº›åœ°æ–¹è¢«ç§°ä¹‹ä¸º *å‰å°*ï¼ˆ*front of house*ï¼‰ï¼Œè¿˜æœ‰å¦å¤–ä¸€äº›åœ°æ–¹è¢«ç§°ä¹‹ä¸º *åå°*ï¼ˆ*back of house*ï¼‰ã€‚å‰å°æ˜¯æ‹›å¾…é¡¾å®¢çš„åœ°æ–¹ï¼Œåœ¨è¿™é‡Œï¼Œåº—ä¸»å¯ä»¥ä¸ºé¡¾å®¢å®‰æ’åº§ä½ï¼ŒæœåŠ¡å‘˜æ¥å—é¡¾å®¢ä¸‹å•å’Œä»˜æ¬¾ï¼Œè°ƒé…’å¸ˆä¼šåˆ¶ä½œé¥®å“ã€‚åå°åˆ™æ˜¯ç”±å¨å¸ˆå·¥ä½œçš„å¨æˆ¿ï¼Œæ´—ç¢—å·¥çš„å·¥ä½œåœ°ç‚¹ï¼Œä»¥åŠç»ç†åšè¡Œæ”¿å·¥ä½œçš„åœ°æ–¹ç»„æˆã€‚

æˆ‘ä»¬å¯ä»¥å°†å‡½æ•°æ”¾ç½®åˆ°åµŒå¥—çš„æ¨¡å—ä¸­ï¼Œæ¥ä½¿æˆ‘ä»¬çš„ crate ç»“æ„ä¸å®é™…çš„é¤å…ç»“æ„ç›¸åŒã€‚é€šè¿‡æ‰§è¡Œ `cargo new --lib restaurant`ï¼Œæ¥åˆ›å»ºä¸€ä¸ªæ–°çš„åä¸º `restaurant` çš„åº“ã€‚ç„¶åå°†ç¤ºä¾‹ 7-1 ä¸­æ‰€ç½—åˆ—å‡ºæ¥çš„ä»£ç æ”¾å…¥ *src/lib.rs* ä¸­ï¼Œæ¥å®šä¹‰ä¸€äº›æ¨¡å—å’Œå‡½æ•°ã€‚

æ–‡ä»¶åï¼šsrc/lib.rs

```rust
mod front_of_house {
    mod hosting {
        fn add_to_waitlist() {}

        fn seat_at_table() {}
    }

    mod serving {
        fn take_order() {}

        fn serve_order() {}

        fn take_payment() {}
    }
}
```

ç¤ºä¾‹ 7-1ï¼šä¸€ä¸ªåŒ…å«äº†å…¶ä»–å†…ç½®äº†å‡½æ•°çš„æ¨¡å—çš„ `front_of_house` æ¨¡å—

æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ¨¡å—ï¼Œæ˜¯ä»¥ `mod` å…³é”®å­—ä¸ºèµ·å§‹ï¼Œç„¶åæŒ‡å®šæ¨¡å—çš„åå­—ï¼ˆæœ¬ä¾‹ä¸­å«åš `front_of_house`ï¼‰ï¼Œå¹¶ä¸”ç”¨èŠ±æ‹¬å·åŒ…å›´æ¨¡å—çš„ä¸»ä½“ã€‚åœ¨æ¨¡å—å†…ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å®šä¹‰å…¶ä»–çš„æ¨¡å—ï¼Œå°±åƒæœ¬ä¾‹ä¸­çš„ `hosting` å’Œ `serving` æ¨¡å—ã€‚æ¨¡å—è¿˜å¯ä»¥ä¿å­˜ä¸€äº›å®šä¹‰çš„å…¶ä»–é¡¹ï¼Œæ¯”å¦‚ç»“æ„ä½“ã€æšä¸¾ã€å¸¸é‡ã€ç‰¹æ€§ã€æˆ–è€…å‡½æ•°ã€‚

ä¸‹é¢å±•ç¤ºäº†ç¤ºä¾‹ 7-1 ä¸­çš„æ¨¡å—æ ‘çš„ç»“æ„ï¼š

```text
crate
 â””â”€â”€ front_of_house
     â”œâ”€â”€ hosting
     â”‚   â”œâ”€â”€ add_to_waitlist
     â”‚   â””â”€â”€ seat_at_table
     â””â”€â”€ serving
         â”œâ”€â”€ take_order
         â”œâ”€â”€ serve_order
         â””â”€â”€ take_payment
```

#### å¼•ç”¨æ¨¡å—é¡¹ç›®çš„è·¯å¾„

æ¥çœ‹ä¸€ä¸‹ Rust å¦‚ä½•åœ¨æ¨¡å—æ ‘ä¸­æ‰¾åˆ°ä¸€ä¸ªé¡¹çš„ä½ç½®ï¼Œæˆ‘ä»¬ä½¿ç”¨è·¯å¾„çš„æ–¹å¼ï¼Œå°±åƒåœ¨æ–‡ä»¶ç³»ç»Ÿä½¿ç”¨è·¯å¾„ä¸€æ ·ã€‚ä¸ºäº†è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“å®ƒçš„è·¯å¾„ã€‚

è·¯å¾„æœ‰ä¸¤ç§å½¢å¼ï¼š

- **ç»å¯¹è·¯å¾„**ï¼ˆ*absolute path*ï¼‰æ˜¯ä»¥ crate æ ¹ï¼ˆrootï¼‰å¼€å¤´çš„å…¨è·¯å¾„ï¼›å¯¹äºå¤–éƒ¨ crate çš„ä»£ç ï¼Œæ˜¯ä»¥ crate åå¼€å¤´çš„ç»å¯¹è·¯å¾„ï¼Œå¯¹äºå½“å‰ crate çš„ä»£ç ï¼Œåˆ™ä»¥å­—é¢å€¼ `crate` å¼€å¤´ã€‚
- **ç›¸å¯¹è·¯å¾„**ï¼ˆ*relative path*ï¼‰ä»å½“å‰æ¨¡å—å¼€å§‹ï¼Œä»¥ `self`ã€`super` æˆ–å½“å‰æ¨¡å—çš„æ ‡è¯†ç¬¦å¼€å¤´ã€‚

ç»å¯¹è·¯å¾„å’Œç›¸å¯¹è·¯å¾„éƒ½åè·Ÿä¸€ä¸ªæˆ–å¤šä¸ªç”±åŒå†’å·ï¼ˆ`::`ï¼‰åˆ†å‰²çš„æ ‡è¯†ç¬¦ã€‚

æˆ‘ä»¬åœ¨ crate æ ¹å®šä¹‰äº†ä¸€ä¸ªæ–°å‡½æ•° `eat_at_restaurant`ï¼Œå¹¶åœ¨å…¶ä¸­å±•ç¤ºè°ƒç”¨ `add_to_waitlist` å‡½æ•°çš„ä¸¤ç§æ–¹æ³•ã€‚`eat_at_restaurant` å‡½æ•°æ˜¯æˆ‘ä»¬ crate åº“çš„ä¸€ä¸ªå…¬å…± APIï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ `pub` å…³é”®å­—æ¥æ ‡è®°å®ƒã€‚æ³¨æ„ï¼Œè¿™ä¸ªä¾‹å­æ— æ³•ç¼–è¯‘é€šè¿‡ï¼Œæˆ‘ä»¬ç¨åä¼šè§£é‡ŠåŸå› ã€‚

```rust
mod front_of_house {
    mod hosting {
        fn add_to_waitlist() {}
    }
}

pub fn eat_at_restaurant() {
    // ç»å¯¹è·¯å¾„
    crate::front_of_house::hosting::add_to_waitlist();

    // ç›¸å¯¹è·¯å¾„
    front_of_house::hosting::add_to_waitlist();
}
```

é”™è¯¯ä¿¡æ¯è¯´ `hosting` æ¨¡å—æ˜¯ç§æœ‰çš„ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬æ‹¥æœ‰ `hosting` æ¨¡å—å’Œ `add_to_waitlist` å‡½æ•°çš„çš„æ­£ç¡®è·¯å¾„ï¼Œä½†æ˜¯ Rust ä¸è®©æˆ‘ä»¬ä½¿ç”¨ï¼Œå› ä¸ºå®ƒä¸èƒ½è®¿é—®ç§æœ‰ç‰‡æ®µã€‚**åœ¨ Rust ä¸­ï¼Œé»˜è®¤æ‰€æœ‰é¡¹ï¼ˆå‡½æ•°ã€æ–¹æ³•ã€ç»“æ„ä½“ã€æšä¸¾ã€æ¨¡å—å’Œå¸¸é‡ï¼‰å¯¹çˆ¶æ¨¡å—éƒ½æ˜¯ç§æœ‰çš„ã€‚**å¦‚æœå¸Œæœ›åˆ›å»ºä¸€ä¸ªç§æœ‰å‡½æ•°æˆ–ç»“æ„ä½“ï¼Œä½ å¯ä»¥å°†å…¶æ”¾å…¥ä¸€ä¸ªæ¨¡å—ã€‚

```rust
mod front_of_house {
    pub mod hosting {
        pub fn add_to_waitlist() {}
    }
}

pub fn eat_at_restaurant() {
    // ç»å¯¹è·¯å¾„
    crate::front_of_house::hosting::add_to_waitlist();

    // ç›¸å¯¹è·¯å¾„
    front_of_house::hosting::add_to_waitlist();
}
```

ç°åœ¨ä»£ç å¯ä»¥ç¼–è¯‘é€šè¿‡äº†ï¼æ¨¡å—å…¬æœ‰å¹¶ä¸ä½¿å…¶å†…å®¹ä¹Ÿæ˜¯å…¬æœ‰çš„ã€‚æ¨¡å—ä¸Šçš„ `pub` å…³é”®å­—åªå…è®¸å…¶çˆ¶æ¨¡å—å¼•ç”¨å®ƒï¼Œè€Œä¸å…è®¸è®¿é—®å†…éƒ¨ä»£ç ã€‚å› ä¸ºæ¨¡å—æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œåªæ˜¯å°†æ¨¡å—å˜ä¸ºå…¬æœ‰èƒ½åšçš„å…¶å®å¹¶ä¸å¤ªå¤šï¼›åŒæ—¶éœ€è¦æ›´æ·±å…¥åœ°é€‰æ‹©å°†ä¸€ä¸ªæˆ–å¤šä¸ªé¡¹å˜ä¸ºå…¬æœ‰ã€‚



> #### äºŒè¿›åˆ¶å’Œåº“ crate åŒ…çš„æœ€ä½³å®è·µ
>
> æˆ‘ä»¬æåˆ°è¿‡åŒ…å¯ä»¥åŒæ—¶åŒ…å«ä¸€ä¸ª *src/main.rs* äºŒè¿›åˆ¶ crate æ ¹å’Œä¸€ä¸ª *src/lib.rs* åº“ crate æ ¹ï¼Œå¹¶ä¸”è¿™ä¸¤ä¸ª crate é»˜è®¤ä»¥åŒ…åæ¥å‘½åã€‚é€šå¸¸ï¼Œè¿™ç§åŒ…å«äºŒè¿›åˆ¶ crate å’Œåº“ crate çš„æ¨¡å¼çš„åŒ…ï¼Œåœ¨äºŒè¿›åˆ¶ crate ä¸­åªæœ‰è¶³å¤Ÿçš„ä»£ç æ¥å¯åŠ¨ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¯æ‰§è¡Œæ–‡ä»¶è°ƒç”¨åº“ crate çš„ä»£ç ã€‚åˆå› ä¸ºåº“ crate å¯ä»¥å…±äº«ï¼Œè¿™ä½¿å¾—å…¶å®ƒé¡¹ç›®ä»åŒ…æä¾›çš„å¤§éƒ¨åˆ†åŠŸèƒ½ä¸­å—ç›Šã€‚
>
> æ¨¡å—æ ‘åº”è¯¥å®šä¹‰åœ¨ *src/lib.rs* ä¸­ã€‚è¿™æ ·é€šè¿‡ä»¥åŒ…åå¼€å¤´çš„è·¯å¾„ï¼Œå…¬æœ‰é¡¹å°±å¯ä»¥åœ¨äºŒè¿›åˆ¶ crate ä¸­ä½¿ç”¨ã€‚äºŒè¿›åˆ¶ crate å°±å®Œå…¨å˜æˆäº†åŒå…¶å®ƒ å¤–éƒ¨ crate ä¸€æ ·çš„åº“ crate çš„ç”¨æˆ·ï¼šå®ƒåªèƒ½ä½¿ç”¨å…¬æœ‰ APIã€‚è¿™æœ‰åŠ©äºä½ è®¾è®¡ä¸€ä¸ªå¥½çš„ APIï¼›ä½ ä¸ä»…ä»…æ˜¯ä½œè€…ï¼Œä¹Ÿæ˜¯ç”¨æˆ·ï¼

#### super å¼€å§‹çš„ç›¸å¯¹è·¯å¾„

æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨è·¯å¾„çš„å¼€å¤´ä½¿ç”¨ `super` ï¼Œä»çˆ¶æ¨¡å—å¼€å§‹æ„å»ºç›¸å¯¹è·¯å¾„ï¼Œè€Œä¸æ˜¯ä»å½“å‰æ¨¡å—æˆ–è€… crate æ ¹å¼€å§‹ã€‚è¿™ç±»ä¼¼ä»¥ `..` è¯­æ³•å¼€å§‹ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿè·¯å¾„ã€‚

è€ƒè™‘ä¸€ä¸‹ä¸‹é¢çš„ä»£ç ï¼Œå®ƒæ¨¡æ‹Ÿäº†å¨å¸ˆæ›´æ­£äº†ä¸€ä¸ªé”™è¯¯è®¢å•ï¼Œå¹¶äº²è‡ªå°†å…¶æä¾›ç»™å®¢æˆ·çš„æƒ…å†µã€‚`back_of_house` æ¨¡å—ä¸­çš„å®šä¹‰çš„ `fix_incorrect_order` å‡½æ•°é€šè¿‡æŒ‡å®šçš„ `super` èµ·å§‹çš„ `serve_order` è·¯å¾„ï¼Œæ¥è°ƒç”¨çˆ¶æ¨¡å—ä¸­çš„ `deliver_order` å‡½æ•°ï¼š

```rust
fn deliver_order() {}

mod back_of_house {
    fn fix_incorrect_order() {
        cook_order();
        super::deliver_order();
    }

    fn cook_order() {}
}
```

å› ä¸ºæˆ‘ä»¬åˆ›å»ºäº†åä¸º `Appetizer` çš„å…¬æœ‰æšä¸¾ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨ `eat_at_restaurant` ä¸­ä½¿ç”¨ `Soup` å’Œ `Salad` æˆå‘˜ã€‚

#### åˆ›å»ºå…¬æœ‰çš„ç»“æ„ä½“å’Œæšä¸¾

å¦‚æœæšä¸¾æˆå‘˜ä¸æ˜¯å…¬æœ‰çš„ï¼Œé‚£ä¹ˆæšä¸¾ä¼šæ˜¾å¾—ç”¨å¤„ä¸å¤§ï¼›ç»™æšä¸¾çš„æ‰€æœ‰æˆå‘˜æŒ¨ä¸ªæ·»åŠ  `pub` æ˜¯å¾ˆä»¤äººæ¼ç«çš„ï¼Œå› æ­¤æšä¸¾æˆå‘˜é»˜è®¤å°±æ˜¯å…¬æœ‰çš„ã€‚ç»“æ„ä½“é€šå¸¸ä½¿ç”¨æ—¶ï¼Œä¸å¿…å°†å®ƒä»¬çš„å­—æ®µå…¬æœ‰åŒ–ï¼Œå› æ­¤ç»“æ„ä½“éµå¾ªå¸¸è§„ï¼Œå†…å®¹å…¨éƒ¨æ˜¯ç§æœ‰çš„ï¼Œé™¤éä½¿ç”¨ `pub` å…³é”®å­—ã€‚

```rust
mod back_of_house {
    pub enum Appetizer {
        Soup,
        Salad,
    }
}

pub fn eat_at_restaurant() {
    let order1 = back_of_house::Appetizer::Soup;
    let order2 = back_of_house::Appetizer::Salad;
}
```

#### ä½¿ç”¨ `use` å…³é”®å­—å°†è·¯å¾„å¼•å…¥ä½œç”¨åŸŸ

ä¸å¾—ä¸ç¼–å†™è·¯å¾„æ¥è°ƒç”¨å‡½æ•°æ˜¾å¾—ä¸ä¾¿ä¸”é‡å¤ã€‚åœ¨ç¤ºä¾‹ä¸­ï¼Œæ— è®ºæˆ‘ä»¬é€‰æ‹© `add_to_waitlist` å‡½æ•°çš„ç»å¯¹è·¯å¾„è¿˜æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œæ¯æ¬¡æˆ‘ä»¬æƒ³è¦è°ƒç”¨ `add_to_waitlist` æ—¶ï¼Œéƒ½å¿…é¡»æŒ‡å®š`front_of_house` å’Œ `hosting`ã€‚å¹¸è¿çš„æ˜¯ï¼Œæœ‰ä¸€ç§æ–¹æ³•å¯ä»¥ç®€åŒ–è¿™ä¸ªè¿‡ç¨‹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `use` å…³é”®å­—åˆ›å»ºä¸€ä¸ªçŸ­è·¯å¾„ï¼Œç„¶åå°±å¯ä»¥åœ¨ä½œç”¨åŸŸä¸­çš„ä»»ä½•åœ°æ–¹ä½¿ç”¨è¿™ä¸ªæ›´çŸ­çš„åå­—ã€‚

åœ¨ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°† `crate::front_of_house::hosting` æ¨¡å—å¼•å…¥äº† `eat_at_restaurant` å‡½æ•°çš„ä½œç”¨åŸŸï¼Œè€Œæˆ‘ä»¬åªéœ€è¦æŒ‡å®š `hosting::add_to_waitlist` å³å¯åœ¨ `eat_at_restaurant` ä¸­è°ƒç”¨ `add_to_waitlist` å‡½æ•°ã€‚

```rust
mod front_of_house {
    pub mod hosting {
        pub fn add_to_waitlist() {}
    }
}

use crate::front_of_house::hosting;

pub fn eat_at_restaurant() {
    hosting::add_to_waitlist();
}
```

åœ¨ä½œç”¨åŸŸä¸­å¢åŠ  `use` å’Œè·¯å¾„ç±»ä¼¼äºåœ¨æ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»ºè½¯è¿æ¥ï¼ˆç¬¦å·è¿æ¥ï¼Œsymbolic linkï¼‰ã€‚é€šè¿‡åœ¨ crate æ ¹å¢åŠ  `use crate::front_of_house::hosting`ï¼Œç°åœ¨ `hosting` åœ¨ä½œç”¨åŸŸä¸­å°±æ˜¯æœ‰æ•ˆçš„åç§°äº†ï¼Œå¦‚åŒ `hosting` æ¨¡å—è¢«å®šä¹‰äº crate æ ¹ä¸€æ ·ã€‚é€šè¿‡ `use` å¼•å…¥ä½œç”¨åŸŸçš„è·¯å¾„ä¹Ÿä¼šæ£€æŸ¥ç§æœ‰æ€§ï¼ŒåŒå…¶å®ƒè·¯å¾„ä¸€æ ·ã€‚

æ³¨æ„ `use` åªèƒ½åˆ›å»º `use` æ‰€åœ¨çš„ç‰¹å®šä½œç”¨åŸŸå†…çš„çŸ­è·¯å¾„ã€‚ä¸‹é¢çš„ç¤ºä¾‹å°† `eat_at_restaurant` å‡½æ•°ç§»åŠ¨åˆ°äº†ä¸€ä¸ªå« `customer` çš„å­æ¨¡å—ï¼Œè¿™åˆæ˜¯ä¸€ä¸ªä¸åŒäº `use` è¯­å¥çš„ä½œç”¨åŸŸï¼Œæ‰€ä»¥å‡½æ•°ä½“ä¸èƒ½ç¼–è¯‘ã€‚

```rust
mod front_of_house {
    pub mod hosting {
        pub fn add_to_waitlist() {}
    }
}

use crate::front_of_house::hosting;

mod customer {
    pub fn eat_at_restaurant() {
        hosting::add_to_waitlist();
    }
}
```

#### ä½¿ç”¨ `as` å…³é”®å­—æä¾›æ–°çš„åç§°

ä½¿ç”¨ `use` å°†ä¸¤ä¸ªåŒåç±»å‹å¼•å…¥åŒä¸€ä½œç”¨åŸŸè¿™ä¸ªé—®é¢˜è¿˜æœ‰å¦ä¸€ä¸ªè§£å†³åŠæ³•ï¼šåœ¨è¿™ä¸ªç±»å‹çš„è·¯å¾„åé¢ï¼Œæˆ‘ä»¬ä½¿ç”¨ `as` æŒ‡å®šä¸€ä¸ªæ–°çš„æœ¬åœ°åç§°æˆ–è€…åˆ«åã€‚ç¤ºä¾‹å±•ç¤ºäº†å¦ä¸€ä¸ªç¼–å†™çš„æ–¹æ³•ï¼Œé€šè¿‡ `as` é‡å‘½åå…¶ä¸­ä¸€ä¸ª `Result` ç±»å‹ã€‚

```rust
use std::fmt::Result;
use std::io::Result as IoResult;

fn function1() -> Result {
    // --snip--
}

fn function2() -> IoResult<()> {
    // --snip--
}
```

#### ä½¿ç”¨ `pub use` é‡å¯¼å‡ºåç§°

ä½¿ç”¨ `use` å…³é”®å­—ï¼Œå°†æŸä¸ªåç§°å¯¼å…¥å½“å‰ä½œç”¨åŸŸåï¼Œè¿™ä¸ªåç§°åœ¨æ­¤ä½œç”¨åŸŸä¸­å°±å¯ä»¥ä½¿ç”¨äº†ï¼Œä½†å®ƒå¯¹æ­¤ä½œç”¨åŸŸä¹‹å¤–è¿˜æ˜¯ç§æœ‰çš„ã€‚å¦‚æœæƒ³è®©å…¶ä»–äººè°ƒç”¨æˆ‘ä»¬çš„ä»£ç æ—¶ï¼Œä¹Ÿèƒ½å¤Ÿæ­£å¸¸ä½¿ç”¨è¿™ä¸ªåç§°ï¼Œå°±å¥½åƒå®ƒæœ¬æ¥å°±åœ¨å½“å‰ä½œç”¨åŸŸä¸€æ ·ï¼Œé‚£æˆ‘ä»¬å¯ä»¥å°† `pub` å’Œ `use` åˆèµ·æ¥ä½¿ç”¨ã€‚è¿™ç§æŠ€æœ¯è¢«ç§°ä¸º â€œ**é‡å¯¼å‡º**ï¼ˆ*re-exporting*ï¼‰â€ï¼šæˆ‘ä»¬ä¸ä»…å°†ä¸€ä¸ªåç§°å¯¼å…¥äº†å½“å‰ä½œç”¨åŸŸï¼Œè¿˜å…è®¸åˆ«äººæŠŠå®ƒå¯¼å…¥ä»–ä»¬è‡ªå·±çš„ä½œç”¨åŸŸã€‚

ç¤ºä¾‹ 7-17 å°†ç¤ºä¾‹ 7-11 æ ¹æ¨¡å—ä¸­çš„ `use` æ”¹ä¸º `pub use` ã€‚

æ–‡ä»¶åï¼šsrc/lib.rs

```rust
mod front_of_house {
    pub mod hosting {
        pub fn add_to_waitlist() {}
    }
}

pub use crate::front_of_house::hosting;

pub fn eat_at_restaurant() {
    hosting::add_to_waitlist();
}
```

åœ¨è¿™ä¸ªä¿®æ”¹ä¹‹å‰ï¼Œå¤–éƒ¨ä»£ç éœ€è¦ä½¿ç”¨è·¯å¾„ `restaurant::front_of_house::hosting::add_to_waitlist()` æ¥è°ƒç”¨ `add_to_waitlist` å‡½æ•°ã€‚ç°åœ¨è¿™ä¸ª `pub use` ä»æ ¹æ¨¡å—é‡å¯¼å‡ºäº† `hosting` æ¨¡å—ï¼Œå¤–éƒ¨ä»£ç ç°åœ¨å¯ä»¥ä½¿ç”¨è·¯å¾„ `restaurant::hosting::add_to_waitlist`ã€‚

#### ä½¿ç”¨å¤–éƒ¨åŒ…

åœ¨ç¬¬äºŒç« ä¸­æˆ‘ä»¬ç¼–å†™äº†ä¸€ä¸ªçŒœçŒœçœ‹æ¸¸æˆã€‚é‚£ä¸ªé¡¹ç›®ä½¿ç”¨äº†ä¸€ä¸ªå¤–éƒ¨åŒ…ï¼Œ`rand`ï¼Œæ¥ç”Ÿæˆéšæœºæ•°ã€‚ä¸ºäº†åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ `rand`ï¼Œåœ¨ *Cargo.toml* ä¸­åŠ å…¥äº†å¦‚ä¸‹è¡Œï¼š

æ–‡ä»¶åï¼šCargo.toml

```toml
rand = "0.8.5"
```

åœ¨ *Cargo.toml* ä¸­åŠ å…¥ `rand` ä¾èµ–å‘Šè¯‰äº† Cargo è¦ä» [crates.io](https://crates.io/) ä¸‹è½½ `rand` å’Œå…¶ä¾èµ–ï¼Œå¹¶ä½¿å…¶å¯åœ¨é¡¹ç›®ä»£ç ä¸­ä½¿ç”¨ã€‚

æ¥ç€ï¼Œä¸ºäº†å°† `rand` å®šä¹‰å¼•å…¥é¡¹ç›®åŒ…çš„ä½œç”¨åŸŸï¼Œæˆ‘ä»¬åŠ å…¥ä¸€è¡Œ `use` èµ·å§‹çš„åŒ…åï¼Œå®ƒä»¥ `rand` åŒ…åå¼€å¤´å¹¶åˆ—å‡ºäº†éœ€è¦å¼•å…¥ä½œç”¨åŸŸçš„é¡¹ã€‚å›å¿†ä¸€ä¸‹ç¬¬äºŒç« çš„ â€œç”Ÿæˆä¸€ä¸ªéšæœºæ•°â€ éƒ¨åˆ†ï¼Œæˆ‘ä»¬æ›¾å°† `Rng` trait å¼•å…¥ä½œç”¨åŸŸå¹¶è°ƒç”¨äº† `rand::thread_rng` å‡½æ•°ï¼š

```rust
use rand::Rng;

fn main() {
    let secret_number = rand::thread_rng().gen_range(1..=100);
}
```

#### åµŒå¥—è·¯å¾„æ¥æ¶ˆé™¤å¤§é‡çš„ `use` è¡Œ

å½“éœ€è¦å¼•å…¥å¾ˆå¤šå®šä¹‰äºç›¸åŒåŒ…æˆ–ç›¸åŒæ¨¡å—çš„é¡¹æ—¶ï¼Œä¸ºæ¯ä¸€é¡¹å•ç‹¬åˆ—å‡ºä¸€è¡Œä¼šå ç”¨æºç å¾ˆå¤§çš„ç©ºé—´ã€‚ä¾‹å¦‚çŒœçŒœçœ‹ç« èŠ‚ç¤ºä¾‹ 2-4 ä¸­æœ‰ä¸¤è¡Œ `use` è¯­å¥éƒ½ä» `std` å¼•å…¥é¡¹åˆ°ä½œç”¨åŸŸï¼š

æ–‡ä»¶åï¼šsrc/main.rs

```rust
// --snip--
use std::cmp::Ordering;
use std::io;
// --snip--
```

ç›¸åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åµŒå¥—è·¯å¾„å°†ç›¸åŒçš„é¡¹åœ¨ä¸€è¡Œä¸­å¼•å…¥ä½œç”¨åŸŸã€‚è¿™ä¹ˆåšéœ€è¦æŒ‡å®šè·¯å¾„çš„ç›¸åŒéƒ¨åˆ†ï¼Œæ¥ç€æ˜¯ä¸¤ä¸ªå†’å·ï¼Œæ¥ç€æ˜¯å¤§æ‹¬å·ä¸­çš„å„è‡ªä¸åŒçš„è·¯å¾„éƒ¨åˆ†ï¼Œå¦‚ç¤ºä¾‹ 7-18 æ‰€ç¤ºã€‚

æ–‡ä»¶åï¼šsrc/main.rs

```rust
// --snip--
use std::{cmp::Ordering, io};
// --snip--
```

ç¤ºä¾‹ 7-18: æŒ‡å®šåµŒå¥—çš„è·¯å¾„åœ¨ä¸€è¡Œä¸­å°†å¤šä¸ªå¸¦æœ‰ç›¸åŒå‰ç¼€çš„é¡¹å¼•å…¥ä½œç”¨åŸŸ

åœ¨è¾ƒå¤§çš„ç¨‹åºä¸­ï¼Œä½¿ç”¨åµŒå¥—è·¯å¾„ä»ç›¸åŒåŒ…æˆ–æ¨¡å—ä¸­å¼•å…¥å¾ˆå¤šé¡¹ï¼Œå¯ä»¥æ˜¾è‘—å‡å°‘æ‰€éœ€çš„ç‹¬ç«‹ `use` è¯­å¥çš„æ•°é‡ï¼

æˆ‘ä»¬å¯ä»¥åœ¨è·¯å¾„çš„ä»»ä½•å±‚çº§ä½¿ç”¨åµŒå¥—è·¯å¾„ï¼Œè¿™åœ¨ç»„åˆä¸¤ä¸ªå…±äº«å­è·¯å¾„çš„ `use` è¯­å¥æ—¶éå¸¸æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œç¤ºä¾‹ 7-19 ä¸­å±•ç¤ºäº†ä¸¤ä¸ª `use` è¯­å¥ï¼šä¸€ä¸ªå°† `std::io` å¼•å…¥ä½œç”¨åŸŸï¼Œå¦ä¸€ä¸ªå°† `std::io::Write` å¼•å…¥ä½œç”¨åŸŸï¼š

```rust
use std::io;
use std::io::Write;
```

ç¤ºä¾‹ 7-19: é€šè¿‡ä¸¤è¡Œ `use` è¯­å¥å¼•å…¥ä¸¤ä¸ªè·¯å¾„ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯å¦ä¸€ä¸ªçš„å­è·¯å¾„

ä¸¤ä¸ªè·¯å¾„çš„ç›¸åŒéƒ¨åˆ†æ˜¯ `std::io`ï¼Œè¿™æ­£æ˜¯ç¬¬ä¸€ä¸ªè·¯å¾„ã€‚ä¸ºäº†åœ¨ä¸€è¡Œ `use` è¯­å¥ä¸­å¼•å…¥è¿™ä¸¤ä¸ªè·¯å¾„ï¼Œå¯ä»¥åœ¨åµŒå¥—è·¯å¾„ä¸­ä½¿ç”¨ `self`ï¼Œå¦‚ç¤ºä¾‹ 7-20 æ‰€ç¤ºã€‚

æ–‡ä»¶åï¼šsrc/lib.rs

```rust
use std::io::{self, Write};
```

ç¤ºä¾‹ 7-20: å°†ç¤ºä¾‹ 7-19 ä¸­éƒ¨åˆ†é‡å¤çš„è·¯å¾„åˆå¹¶ä¸ºä¸€ä¸ª `use` è¯­å¥

è¿™ä¸€è¡Œä¾¿å°† `std::io` å’Œ `std::io::Write` åŒæ—¶å¼•å…¥ä½œç”¨åŸŸã€‚

#### é€šè¿‡`*`è¿ç®—ç¬¦å°†æ‰€æœ‰çš„å…¬æœ‰å®šä¹‰å¼•å…¥ä½œç”¨åŸŸ

å¦‚æœå¸Œæœ›å°†ä¸€ä¸ªè·¯å¾„ä¸‹ **æ‰€æœ‰** å…¬æœ‰é¡¹å¼•å…¥ä½œç”¨åŸŸï¼Œå¯ä»¥æŒ‡å®šè·¯å¾„åè·Ÿ `*`ï¼Œglob è¿ç®—ç¬¦ï¼š

```rust
use std::collections::*;
```

è¿™ä¸ª `use` è¯­å¥å°† `std::collections` ä¸­å®šä¹‰çš„æ‰€æœ‰å…¬æœ‰é¡¹å¼•å…¥å½“å‰ä½œç”¨åŸŸã€‚

#### å°†æ¨¡å—æ‹†åˆ†æˆå¤šä¸ªæ–‡ä»¶

æˆ‘ä»¬ä»ç¤ºä¾‹ 7-17 ä¸­åŒ…å«å¤šä¸ªé¤å…æ¨¡å—çš„ä»£ç å¼€å§‹ã€‚æˆ‘ä»¬ä¼šå°†æ¨¡å—æå–åˆ°å„è‡ªçš„æ–‡ä»¶ä¸­ï¼Œè€Œä¸æ˜¯å°†æ‰€æœ‰æ¨¡å—éƒ½å®šä¹‰åˆ° crate æ ¹æ–‡ä»¶ä¸­ã€‚åœ¨è¿™é‡Œï¼Œcrate æ ¹æ–‡ä»¶æ˜¯ *src/lib.rs*ï¼Œä¸è¿‡è¿™ä¸ªè¿‡ç¨‹ä¹Ÿé€‚ç”¨äº crate æ ¹æ–‡ä»¶æ˜¯ *src/main.rs* çš„äºŒè¿›åˆ¶ crateã€‚

é¦–å…ˆå°† `front_of_house` æ¨¡å—æå–åˆ°å…¶è‡ªå·±çš„æ–‡ä»¶ä¸­ã€‚åˆ é™¤ `front_of_house` æ¨¡å—çš„å¤§æ‹¬å·ä¸­çš„ä»£ç ï¼Œåªç•™ä¸‹ `mod front_of_house;` å£°æ˜ï¼Œè¿™æ · *src/lib.rs* ä¼šåŒ…å«å¦‚ç¤ºä¾‹ 7-21 æ‰€ç¤ºçš„ä»£ç ã€‚æ³¨æ„ç›´åˆ°åˆ›å»ºç¤ºä¾‹ 7-22 ä¸­çš„ *src/front_of_house.rs* æ–‡ä»¶ä¹‹å‰ä»£ç éƒ½ä¸èƒ½ç¼–è¯‘ã€‚

æ–‡ä»¶åï¼šsrc/lib.rs

```rust
mod front_of_house;

pub use crate::front_of_house::hosting;

pub fn eat_at_restaurant() {
    hosting::add_to_waitlist();
}
```

ç¤ºä¾‹ 7-21: å£°æ˜ `front_of_house` æ¨¡å—ï¼Œå…¶å†…å®¹å°†ä½äº *src/front_of_house.rs*

æ¥ä¸‹æ¥å°†ä¹‹å‰å¤§æ‹¬å·å†…çš„ä»£ç æ”¾å…¥ä¸€ä¸ªåå« *src/front_of_house.rs* çš„æ–°æ–‡ä»¶ä¸­ï¼Œå¦‚ç¤ºä¾‹ 7-22 æ‰€ç¤ºã€‚å› ä¸ºç¼–è¯‘å™¨æ‰¾åˆ°äº† crate æ ¹ä¸­åå« `front_of_house` çš„æ¨¡å—å£°æ˜ï¼Œå®ƒå°±çŸ¥é“å»æœå¯»è¿™ä¸ªæ–‡ä»¶ã€‚

æ–‡ä»¶åï¼šsrc/front_of_house.rs

```rust
pub mod hosting {
    pub fn add_to_waitlist() {}
}
```

ç¤ºä¾‹ 7-22: åœ¨ *src/front_of_house.rs* ä¸­å®šä¹‰ `front_of_house` æ¨¡å—

æ³¨æ„ä½ åªéœ€åœ¨æ¨¡å—æ ‘ä¸­çš„æŸå¤„ä½¿ç”¨ä¸€æ¬¡ `mod` å£°æ˜å°±å¯ä»¥åŠ è½½è¿™ä¸ªæ–‡ä»¶ã€‚ä¸€æ—¦ç¼–è¯‘å™¨çŸ¥é“äº†è¿™ä¸ªæ–‡ä»¶æ˜¯é¡¹ç›®çš„ä¸€éƒ¨åˆ†ï¼ˆå¹¶ä¸”é€šè¿‡ `mod` è¯­å¥çš„ä½ç½®çŸ¥é“äº†ä»£ç åœ¨æ¨¡å—æ ‘ä¸­çš„ä½ç½®ï¼‰ï¼Œé¡¹ç›®ä¸­çš„å…¶ä»–æ–‡ä»¶åº”è¯¥ä½¿ç”¨å…¶æ‰€å£°æ˜çš„ä½ç½®çš„è·¯å¾„æ¥å¼•ç”¨é‚£ä¸ªæ–‡ä»¶çš„ä»£ç ï¼Œè¿™åœ¨[â€œå¼•ç”¨æ¨¡å—é¡¹ç›®çš„è·¯å¾„â€](https://kaisery.github.io/trpl-zh-cn/ch07-03-paths-for-referring-to-an-item-in-the-module-tree.html)éƒ¨åˆ†æœ‰è®²åˆ°ã€‚**æ¢å¥è¯è¯´ï¼Œ`mod` ä¸æ˜¯ä½ å¯èƒ½ä¼šåœ¨å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­çœ‹åˆ°çš„ "include" æ“ä½œã€‚**

> #### å¦ä¸€ç§æ–‡ä»¶è·¯å¾„
>
> ç›®å‰ä¸ºæ­¢æˆ‘ä»¬ä»‹ç»äº† Rust ç¼–è¯‘å™¨æ‰€æœ€å¸¸ç”¨çš„æ–‡ä»¶è·¯å¾„ï¼›ä¸è¿‡ä¸€ç§æ›´è€çš„æ–‡ä»¶è·¯å¾„ä¹Ÿä»ç„¶æ˜¯æ”¯æŒçš„ã€‚
>
> å¯¹äºå£°æ˜äº crate æ ¹çš„ `front_of_house` æ¨¡å—ï¼Œç¼–è¯‘å™¨ä¼šåœ¨å¦‚ä¸‹ä½ç½®æŸ¥æ‰¾æ¨¡å—ä»£ç ï¼š
>
> - *src/front_of_house.rs*ï¼ˆæˆ‘ä»¬æ‰€ä»‹ç»çš„ï¼‰
> - *src/front_of_house/mod.rs*ï¼ˆè€é£æ ¼ï¼Œä¸è¿‡ä»ç„¶æ”¯æŒï¼‰
>
> å¯¹äº `front_of_house` çš„å­æ¨¡å— `hosting`ï¼Œç¼–è¯‘å™¨ä¼šåœ¨å¦‚ä¸‹ä½ç½®æŸ¥æ‰¾æ¨¡å—ä»£ç ï¼š
>
> - *src/front_of_house/hosting.rs*ï¼ˆæˆ‘ä»¬æ‰€ä»‹ç»çš„ï¼‰
> - *src/front_of_house/hosting/mod.rs*ï¼ˆè€é£æ ¼ï¼Œä¸è¿‡ä»ç„¶æ”¯æŒï¼‰
>
> å¦‚æœä½ å¯¹åŒä¸€æ¨¡å—åŒæ—¶ä½¿ç”¨è¿™ä¸¤ç§è·¯å¾„é£æ ¼ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªç¼–è¯‘é”™è¯¯ã€‚åœ¨åŒä¸€é¡¹ç›®ä¸­çš„ä¸åŒæ¨¡å—æ··ç”¨ä¸åŒçš„è·¯å¾„é£æ ¼æ˜¯å…è®¸çš„ï¼Œä¸è¿‡è¿™ä¼šä½¿ä»–äººæ„Ÿåˆ°ç–‘æƒ‘ã€‚
>
> ä½¿ç”¨ *mod.rs* è¿™ä¸€æ–‡ä»¶åçš„é£æ ¼çš„ä¸»è¦ç¼ºç‚¹æ˜¯ä¼šå¯¼è‡´é¡¹ç›®ä¸­å‡ºç°å¾ˆå¤š *mod.rs* æ–‡ä»¶ï¼Œå½“ä½ åœ¨ç¼–è¾‘å™¨ä¸­åŒæ—¶æ‰“å¼€å®ƒä»¬æ—¶ä¼šæ„Ÿåˆ°ç–‘æƒ‘ã€‚